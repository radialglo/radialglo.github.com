
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Anthony Su</title>
  <meta name="author" content="Anthony Su">

  
  <meta name="description" content="Introduction In JavaScript: The Good Parts, Douglas Crockford disapproves of Pseudoclassical Inheritance
in favor of Functional Inheritance. However &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://radialglo.github.com">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Anthony Su" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-50887935-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Anthony Su</a></h1>
  
    <h2>coding adventures</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:radialglo.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/24/understanding-pseudoclassical-inheritance-in-javascript/">Understanding Pseudoclassical Inheritance in JavaScript</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-11-24T22:49:00-08:00" pubdate data-updated="true">Nov 24<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Introduction</h2>

<p>In <a href="http://shop.oreilly.com/product/9780596517748.do">JavaScript: The Good Parts</a>, <a href="http://www.crockford.com/">Douglas Crockford</a> disapproves of <strong>Pseudoclassical Inheritance</strong>
in favor of <strong>Functional Inheritance</strong>. However, a quick survey of JavaScript resources such as <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Introduction_to_Object-Oriented_JavaScript">Mozilla Developer Network(MDN)</a> and JavaScript Tools/Libraries such as  <a href="https://github.com/google/closure-library">Google Closure</a>, <a href="http://coffeescript.org/">CoffeeScript</a>, <a href="http://www.yuiblog.com/blog/2010/01/06/inheritance-patterns-in-yui-3/">YUI3</a>, and <a href="https://github.com/jasmine/jasmine">Jasmine</a> indicate that Pseudoclassical pattern seems to be quite a popular inheritance pattern.</p>

<h2>Drawbacks of Functional Inheritance</h2>

<p><a href="http://bolinfest.com/">Michael Bolin</a> who was a core contributor to Google Closure presents
a strong case for Pseudoclassical Inheritance in his blog post <a href="http://bolinfest.com/javascript/inheritance.php">Inheritance Patterns in JavaScript</a>.
In his post he discusses drawbacks for using Functional Inheritance and also addresses Douglas Crockford&#8217;s concerns for Pseudoclassical Inheritance.</p>

<p>Here is an example of Functional Inheritance from Douglas Crockford&#8217;s book:</p>

<figure class='code'><figcaption><span>Functional Inheritance Example</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">mammal</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">spec</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="p">{};</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">that</span><span class="p">.</span><span class="nx">get_name</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="nx">spec</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">that</span><span class="p">.</span><span class="nx">says</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">spec</span><span class="p">.</span><span class="nx">saying</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="nx">that</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">cat</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">spec</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">spec</span><span class="p">.</span><span class="nx">saying</span> <span class="o">=</span> <span class="nx">spec</span><span class="p">.</span><span class="nx">saying</span> <span class="o">||</span> <span class="s1">&#39;meow&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="nx">mammal</span><span class="p">(</span><span class="nx">spec</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">that</span><span class="p">.</span><span class="nx">purr</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">s</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>            <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">s</span> <span class="o">+=</span> <span class="s1">&#39;-&#39;</span><span class="p">;</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>            <span class="nx">s</span> <span class="o">+=</span> <span class="s1">&#39;r&#39;</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="nx">s</span><span class="p">;</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>    <span class="nx">that</span><span class="p">.</span><span class="nx">get_name</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">that</span><span class="p">.</span><span class="nx">says</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nx">spec</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nx">that</span><span class="p">.</span><span class="nx">says</span><span class="p">();</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">that</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">myMammal</span> <span class="o">=</span> <span class="nx">mammal</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Herb&#39;</span><span class="p">});</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">myCat</span> <span class="o">=</span> <span class="nx">cat</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Fiona&#39;</span><span class="p">});</span>
</span><span class='line'>    <span class="nx">myCat</span><span class="p">.</span><span class="nx">get_name</span><span class="p">();</span> <span class="c1">// &quot;meow Fiona meow&quot;</span>
</span><span class='line'>    <span class="nx">myCat</span><span class="p">.</span><span class="nx">purr</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="c1">// &quot;r-r-r-r-r&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>and the same &#8220;classes&#8221; modeled using Pseudoclassical Inheritance:</p>

<figure class='code'><figcaption><span>Pseudoclassical Inheritance Example</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">Mammal</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="nx">Mammal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">get_name</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="nx">Mammal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">says</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">saying</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">Cat</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">Mammal</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="nx">Cat</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Mammal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>
</span><span class='line'><span class="nx">Cat</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">Cat</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nx">Cat</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">saying</span> <span class="o">=</span> <span class="s1">&#39;meow&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nx">Cat</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">purr</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">s</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">s</span> <span class="o">+=</span> <span class="s1">&#39;-&#39;</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="nx">s</span> <span class="o">+=</span> <span class="s1">&#39;r&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="nx">s</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'><span class="nx">Cat</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">get_name</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">says</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">says</span><span class="p">();</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">myMammal</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Mammal</span><span class="p">(</span><span class="s1">&#39;Herb&#39;</span><span class="p">);</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">myCat</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cat</span><span class="p">(</span><span class="s1">&#39;Fiona&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">myCat</span><span class="p">.</span><span class="nx">get_name</span><span class="p">();</span> <span class="c1">// &quot;meow Fiona meow&quot;</span>
</span><span class='line'>    <span class="nx">myCat</span><span class="p">.</span><span class="nx">purr</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="c1">// &quot;r-r-r-r-r&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Main Drawbacks</h3>

<p>I would recommend reading Michael Bolins <a href="http://bolinfest.com/javascript/inheritance.php">Inheritance Patterns in JavaScript</a>
for an in depth explanation of these drawbacks. Note that some of his points are made in respect to Google Closure.</p>

<ol>
<li><p>Instance of types take up more memory</p>

<ul>
<li>Every time <code>mammal()</code> is called, two new functions are created (one per method of the type). Each time, the functions are basically the same, but they are bound to different values. These functions are expensive because each is a closure that maintains a reference for every named variable in the enclosing function in which the closure was defined. This may accidentally prevent objects from being garbage collected, causing a memory leak.</li>
<li>This is not a concern when <code>Mammal</code> is called because of how it takes advantage of prototype-based inheritance. Each method is defined once on <code>Mammal.prototype</code> and is therefore available to every instance of <code>Mammal</code>. This limits the number of function objects that are created and does not run the risk of leaking memory</li>
</ul>
</li>
<li><p>Types cannot be tested using instanceof</p>

<ul>
<li>From <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/instanceof">MDN</a>, the <code>instanceof</code> operator tests
whether an object has in its prototype chain the <code>prototype</code> property of a constructor.

<blockquote><p><code>object instanceof constructor</code></p></blockquote></li>
<li>Since prototypes are not used for implementing inheritance for <code>cat()</code>, there is no appropriate constructor to use for instanceof</li>
</ul>
</li>
<li>Encourages adding properties to Function.prototype and Object.prototype

<ul>
<li>In his book, Crockford augment&#8217;s the prototype to assist in creating superclass methods</li>
</ul>
</li>
</ol>


<figure class='code'><figcaption><span>Prototype Augmentation from JavaScript: The Good Parts</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// From Chapter 4.</span>
</span><span class='line'><span class="nb">Function</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">method</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">func</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">prototype</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">func</span><span class="p">;</span>
</span><span class='line'>  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// From Chapter 5.</span>
</span><span class='line'><span class="nb">Object</span><span class="p">.</span><span class="nx">method</span><span class="p">(</span><span class="s1">&#39;superior&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span> <span class="nx">method</span> <span class="o">=</span> <span class="nx">that</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
</span><span class='line'>  <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">method</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">that</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><p>Adding methods to the prototype is dangerous, especially because the <code>for in</code> construct includes properties added to the prototype.</p></li>
<li><p>Makes it impossible to update all instances of a type</p>

<ul>
<li>You need to individually update each instance.</li>
<li>In Pseudoclassical Inheritance, updating all instance of a type is as simple as updating properties or methods on the prototype.</li>
</ul>
</li>
</ul>


<h3>Closure-related/Other Drawbacks</h3>

<ol>
<li>Methods cannot be inlined

<ul>
<li>Methods in the functional pattern are often bound to variables that cannot be referenced externally, so there is no way for Closure Compiler to rewrite method calls in a manner that eliminates the method dispatch</li>
</ul>
</li>
<li>Superclass methods cannot be renamed(or will be renamed incorrectly)

<ul>
<li>Method renaming from JavaScript minifiers can use issues</li>
</ul>
</li>
<li>Results in an extra level of indentation

<ul>
<li>Coding preference</li>
</ul>
</li>
<li>Naming newly created objects is awkward</li>
</ol>


<h2>Naive Implementation of Pseudoclassical Inheritance</h2>

<p>Here is an example of implementing Pseudoclassical Inheritance from <a href="http://bonsaiden.github.io/JavaScript-Garden/#object.prototype">JavaScript Garden</a>.
The main idea is to <strong>create a dummy instance of the parent</strong> <code>Foo</code> via <code>new Foo</code> and also call the parent constructor.</p>

<figure class='code'><figcaption><span>Naive Pseudoclassical Inheritance</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">Foo</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nx">Foo</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">method</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">Bar</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">Foo</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// call parent constructor</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Set Bar&#39;s prototype to a new instance of Foo</span>
</span><span class='line'><span class="nx">Bar</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Foo</span><span class="p">();</span>
</span><span class='line'><span class="nx">Bar</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">foo</span> <span class="o">=</span> <span class="s1">&#39;Hello World&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Make sure to list Bar as the actual constructor</span>
</span><span class='line'><span class="nx">Bar</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">Bar</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">test</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Bar</span><span class="p">();</span> <span class="c1">// create a new bar instance</span>
</span></code></pre></td></tr></table></div></figure>


<p>While this way of implementing Pseudoclassical Inheritance is not wrong per se, there is a little awkwardness to how the child&#8217;s prototype (<code>Bar.prototype</code>) is being set.
Imagine the case, where the parent constructor takes in a couple parameters. It would be strange to invoke the <code>new Parent()</code> with dummy parameters because the instantiated object is a dummy instance. Additionally, the superclass’s constructor may have side effects (i.e. anything instance properties set in the superclass constructor get added to the prototype)or do something that is computationally intensive. Therefore, since the object that gets instantiated for the prototype is usually just a throwaway instance, you don’t want to create it unnecessarily.</p>

<h2>General Implementation of Pseudoclassical Inheritance</h2>

<p>To improve on the naive implementation of Pseudoclassical inheritance, we can <strong>create a dummy constructor</strong>, <strong>set it&#8217;s prototype to the prototype of the parent</strong>,
and <strong>create a dummy instance that is used as the prototype of the child</strong>. Same as before, we also need to reset the prototype.constructor of the child to child(because the prototype needs to reference the appropraite constructor) and call the parent constructor in the child.</p>

<blockquote><p>Use a dummy constructor when creating the object used for the prototype because superclass’s constructor may have side effects or do something that is computationally intensive</p></blockquote>

<p>We can improve the the previous Foo Bar example like so:</p>

<figure class='code'><figcaption><span>PseudoClassical Inheritance</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">Foo</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nx">Foo</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">method</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">Bar</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">Foo</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// call parent constructor</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Set Bar&#39;s prototype to a new dummy instance that has use Foo.prototype for its prototype</span>
</span><span class='line'><span class="nx">Bar</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Foo</span><span class="p">();</span><span class="c1">// Object.create(Foo.prototype)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Make sure to list Bar as the actual constructor</span>
</span><span class='line'><span class="nx">Bar</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">Bar</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">test</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Bar</span><span class="p">();</span> <span class="c1">// create a new bar instance</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/* Test&#39;s prototype chain</span>
</span><span class='line'><span class="cm">  test -&gt; Bar.prototype -&gt; Foo.protoype -&gt; Object -&gt; null</span>
</span><span class='line'><span class="cm">*/</span>
</span></code></pre></td></tr></table></div></figure>


<p>Pay close attention to the use of the native <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create">Object.create</a> method
which creates a new object with the specified prototype object and properties.</p>

<blockquote><p>The <code>Object.create()</code> method creates a new object with the specified prototype object and properties.</p></blockquote>

<p>Here is a simple <a href="http://javascript.crockford.com/prototypal.html">Object.create polyfill</a> from Crockford&#8217;s website.</p>

<figure class='code'><figcaption><span>Object.create</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span> <span class="o">!==</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">o</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="kd">function</span> <span class="nx">F</span><span class="p">()</span> <span class="p">{}</span>
</span><span class='line'>        <span class="nx">F</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">o</span><span class="p">;</span>
</span><span class='line'>        <span class="k">return</span> <span class="k">new</span> <span class="nx">F</span><span class="p">();</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>And an optimized polyfill from <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create">MDN</a></p>

<figure class='code'><figcaption><span>Object.create polyfill</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span> <span class="o">!=</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nb">Object</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{};</span>
</span><span class='line'>    <span class="k">return</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">prototype</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">throw</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Second argument not supported&#39;</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">prototype</span> <span class="o">!=</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">throw</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Argument must be an object&#39;</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">prototype</span><span class="p">;</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Object</span><span class="p">();</span>
</span><span class='line'>      <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>  <span class="p">})();</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Pseudoclassical Inheritance in the wild</h2>

<p>Based on our understanding of why and how to implement Pseudoclassical Inheritance, now we&#8217;ll take
a look at how this pattern is being used for large JavaScript Libraries.</p>

<h3>Google Closure</h3>

<p>Closure is a set of individual JavaScript tools that are also designed to help developers build complex web applications, and is used by Gmail, Google Maps, and Google Docs.
Inheritance in Google Closure is implementance via Pseudoclassical Inheritance. Google closure also adds a <code>base</code> method to the child constructor to expose
a covenient way to invoke parent methods.</p>

<!--
https://developers.google.com/closure/faq#gwt
-->


<figure class='code'><figcaption><span>Inheritance via Google Closure</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm"> * Inherit the prototype methods from one constructor into another.</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> * Usage:</span>
</span><span class='line'><span class="cm"> * &lt;pre&gt;</span>
</span><span class='line'><span class="cm"> * function ParentClass(a, b) { }</span>
</span><span class='line'><span class="cm"> * ParentClass.prototype.foo = function(a) { };</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> * function ChildClass(a, b, c) {</span>
</span><span class='line'><span class="cm"> *   ChildClass.base(this, &#39;constructor&#39;, a, b);</span>
</span><span class='line'><span class="cm"> * }</span>
</span><span class='line'><span class="cm"> * goog.inherits(ChildClass, ParentClass);</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> * var child = new ChildClass(&#39;a&#39;, &#39;b&#39;, &#39;see&#39;);</span>
</span><span class='line'><span class="cm"> * child.foo(); // This works.</span>
</span><span class='line'><span class="cm"> * &lt;/pre&gt;</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> * @param {Function} childCtor Child class.</span>
</span><span class='line'><span class="cm"> * @param {Function} parentCtor Parent class.</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="nx">goog</span><span class="p">.</span><span class="nx">inherits</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">childCtor</span><span class="p">,</span> <span class="nx">parentCtor</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="cm">/** @constructor */</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">tempCtor</span><span class="p">()</span> <span class="p">{};</span>
</span><span class='line'>  <span class="nx">tempCtor</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">parentCtor</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
</span><span class='line'>  <span class="nx">childCtor</span><span class="p">.</span><span class="nx">superClass_</span> <span class="o">=</span> <span class="nx">parentCtor</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
</span><span class='line'>  <span class="nx">childCtor</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">tempCtor</span><span class="p">();</span>
</span><span class='line'>  <span class="cm">/** @override */</span>
</span><span class='line'>  <span class="nx">childCtor</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">childCtor</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/**</span>
</span><span class='line'><span class="cm">   * Calls superclass constructor/method.</span>
</span><span class='line'><span class="cm">   *</span>
</span><span class='line'><span class="cm">   * This function is only available if you use goog.inherits to</span>
</span><span class='line'><span class="cm">   * express inheritance relationships between classes.</span>
</span><span class='line'><span class="cm">   *</span>
</span><span class='line'><span class="cm">   * NOTE: This is a replacement for goog.base and for superClass_</span>
</span><span class='line'><span class="cm">   * property defined in childCtor.</span>
</span><span class='line'><span class="cm">   *</span>
</span><span class='line'><span class="cm">   * @param {!Object} me Should always be &quot;this&quot;.</span>
</span><span class='line'><span class="cm">   * @param {string} methodName The method name to call. Calling</span>
</span><span class='line'><span class="cm">   *     superclass constructor can be done with the special string</span>
</span><span class='line'><span class="cm">   *     &#39;constructor&#39;.</span>
</span><span class='line'><span class="cm">   * @param {...*} var_args The arguments to pass to superclass</span>
</span><span class='line'><span class="cm">   *     method/constructor.</span>
</span><span class='line'><span class="cm">   * @return {*} The return value of the superclass method/constructor.</span>
</span><span class='line'><span class="cm">   */</span>
</span><span class='line'>  <span class="nx">childCtor</span><span class="p">.</span><span class="nx">base</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">me</span><span class="p">,</span> <span class="nx">methodName</span><span class="p">,</span> <span class="nx">var_args</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">parentCtor</span><span class="p">.</span><span class="nx">prototype</span><span class="p">[</span><span class="nx">methodName</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="nx">me</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<!--
https://github.com/google/closure-library/blob/master/closure/goog/base.js#L2087-L2137
-->


<h3>CoffeeScript</h3>

<p>In addition to using Pseudoclassical inheritance for the underlying implementation of CoffeeScript,
<a href="https://twitter.com/jashkenas">Jeremy Askenas</a> also discusses inconviences to libraries that try to
provide a cleaner syntax for classical inheritance.</p>

<blockquote><p>JavaScript&#8217;s prototypal inheritance has always been a bit of a brain-bender, with a whole family tree of libraries that provide a cleaner syntax for classical inheritance on top of JavaScript&#8217;s prototypes: <a href="https://code.google.com/p/base2/">Base2</a>, <a href="http://prototypejs.org/">Prototype.js</a>, <a href="http://prototypejs.org/">JS.Class</a>, etc. The libraries provide syntactic sugar, but the built-in inheritance would be completely usable if it weren&#8217;t for a couple of small exceptions: it&#8217;s awkward to call super (the prototype object&#8217;s implementation of the current function), and it&#8217;s awkward to correctly set the prototype chain.</p></blockquote>

<p>The crux of Jeremy&#8217;s implementation of Pseudoclassical inheritance is the  <code>__extends</code> function.
An interesting part of the implementation is the for loop which <strong>copies static methods</strong> from the parent
onto the child.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'> <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">__hasProp</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">parent</span><span class="p">,</span> <span class="nx">key</span><span class="p">))</span> <span class="nx">child</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<!--
http://coffeescript.org/#classes
-->




<figure class='code'><figcaption><span>Inheritance implemented in compiled-down CoffeeScript  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">Animal</span><span class="p">,</span> <span class="nx">Horse</span><span class="p">,</span> <span class="nx">Snake</span><span class="p">,</span> <span class="nx">sam</span><span class="p">,</span> <span class="nx">tom</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">__hasProp</span> <span class="o">=</span> <span class="p">{}.</span><span class="nx">hasOwnProperty</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">__extends</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">child</span><span class="p">,</span> <span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">if</span> <span class="p">(</span><span class="nx">__hasProp</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">parent</span><span class="p">,</span> <span class="nx">key</span><span class="p">))</span> <span class="nx">child</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="kd">function</span> <span class="nx">ctor</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">child</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="nx">ctor</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
</span><span class='line'>        <span class="nx">child</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ctor</span><span class="p">();</span>
</span><span class='line'>        <span class="nx">child</span><span class="p">.</span><span class="nx">__super__</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">child</span><span class="p">;</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="nx">Animal</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">Animal</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">Animal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">move</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">meters</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">alert</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot; moved &quot;</span> <span class="o">+</span> <span class="nx">meters</span> <span class="o">+</span> <span class="s2">&quot;m.&quot;</span><span class="p">));</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="nx">Animal</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="p">})();</span>
</span><span class='line'>
</span><span class='line'><span class="nx">Snake</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">_super</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">__extends</span><span class="p">(</span><span class="nx">Snake</span><span class="p">,</span> <span class="nx">_super</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">Snake</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">Snake</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">Snake</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">move</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Slithering...&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">Snake</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">move</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="nx">Snake</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="p">})(</span><span class="nx">Animal</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Jasmine</h3>

<!--
https://github.com/jasmine/jasmine/blob/master/src/core/util.js
https://github.com/jasmine/jasmine/blob/master/src/core/util.js#L3-L10
-->


<p><a href="http://jasmine.github.io/2.0/introduction.html">Jasmine</a> is a behavior-driven development framework for testing JavaScript code. In Jasmine,
inherit is attached to the utility object util.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>  <span class="nx">util</span><span class="p">.</span><span class="nx">inherit</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">childClass</span><span class="p">,</span> <span class="nx">parentClass</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">Subclass</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>    <span class="nx">Subclass</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">parentClass</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">childClass</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Subclass</span><span class="p">();</span>
</span><span class='line'>  <span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<h3>YUI3</h3>

<p>YUI is a free, open source JavaScript and CSS library from Yahoo for building richly interactive web applications.</p>

<p>The method in YUI for inheritance is <code>Y.extend</code> used like so <code>Y.extend(Programmer, Person);</code> where a Programmer inherits from Person.</p>

<!--
http://www.yuiblog.com/blog/2010/01/06/inheritance-patterns-in-yui-3/
https://github.com/yui/yui3/blob/master/src/oop/js/oop.js#L181-L220
-->




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm"> * Utility to set up the prototype, constructor and superclass properties to</span>
</span><span class='line'><span class="cm"> * support an inheritance strategy that can chain constructors and methods.</span>
</span><span class='line'><span class="cm"> * Static members will not be inherited.</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> * @method extend</span>
</span><span class='line'><span class="cm"> * @param {function} r   the object to modify.</span>
</span><span class='line'><span class="cm"> * @param {function} s the object to inherit.</span>
</span><span class='line'><span class="cm"> * @param {object} px prototype properties to add/override.</span>
</span><span class='line'><span class="cm"> * @param {object} sx static properties to add/override.</span>
</span><span class='line'><span class="cm"> * @return {object} the extended object.</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="nx">Y</span><span class="p">.</span><span class="nx">extend</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">px</span><span class="p">,</span> <span class="nx">sx</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">s</span> <span class="o">||</span> <span class="o">!</span><span class="nx">r</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">Y</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;extend failed, verify dependencies&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">sp</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="nx">rp</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="nx">sp</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">r</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">rp</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">rp</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">r</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">r</span><span class="p">.</span><span class="nx">superclass</span> <span class="o">=</span> <span class="nx">sp</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// assign constructor property</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">s</span> <span class="o">!=</span> <span class="nb">Object</span> <span class="o">&amp;&amp;</span> <span class="nx">sp</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">==</span> <span class="nx">OP</span><span class="p">.</span><span class="nx">constructor</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">sp</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">s</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// add prototype overrides</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">px</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">Y</span><span class="p">.</span><span class="nx">mix</span><span class="p">(</span><span class="nx">rp</span><span class="p">,</span> <span class="nx">px</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// add object overrides</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">sx</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">Y</span><span class="p">.</span><span class="nx">mix</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span> <span class="nx">sx</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="nx">r</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>




<!--
https://github.com/yui/yui3/blob/master/src/yui/js/yui-object.js#L20-L47
-->


<p> <code>Y.Object</code> used within <code>Y.extend</code> is essentially a wrapper
 for <code>Object.create</code> with a fallback. The fallback wraps the dummy constructor around an Immediately Invoked Function Expression(IIFE),
 so that the dummy constuctor can be reused.</p>

<figure class='code'><figcaption><span>Y.Object</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm"> * Returns a new object that uses _obj_ as its prototype. This method wraps the</span>
</span><span class='line'><span class="cm"> * native ES5 `Object.create()` method if available, but doesn&#39;t currently</span>
</span><span class='line'><span class="cm"> * pass through `Object.create()`&#39;s second argument (properties) in order to</span>
</span><span class='line'><span class="cm"> * ensure compatibility with older browsers.</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> * @method ()</span>
</span><span class='line'><span class="cm"> * @param {Object} obj Prototype object.</span>
</span><span class='line'><span class="cm"> * @return {Object} New object using _obj_ as its prototype.</span>
</span><span class='line'><span class="cm"> * @static</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="nx">O</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nb">Object</span> <span class="o">=</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">_isNative</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">)</span> <span class="o">?</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// We currently wrap the native Object.create instead of simply aliasing it</span>
</span><span class='line'>    <span class="c1">// to ensure consistency with our fallback shim, which currently doesn&#39;t</span>
</span><span class='line'>    <span class="c1">// support Object.create()&#39;s second argument (properties). Once we have a</span>
</span><span class='line'>    <span class="c1">// safe fallback for the properties arg, we can stop wrapping</span>
</span><span class='line'>    <span class="c1">// Object.create().</span>
</span><span class='line'>    <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span> <span class="o">:</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// Reusable constructor function for the Object.create() shim.</span>
</span><span class='line'>    <span class="kd">function</span> <span class="nx">F</span><span class="p">()</span> <span class="p">{}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// The actual shim.</span>
</span><span class='line'>    <span class="k">return</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">F</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">;</span>
</span><span class='line'>        <span class="k">return</span> <span class="k">new</span> <span class="nx">F</span><span class="p">();</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'><span class="p">}()),</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Conclusion</h2>

<p>I hope this article sheds light on the advantages of using Pseudoclassical Inheritance over Functional Inheritance and clarifies
how to implement Pseudoclassical Inheritance in an optimal manner.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/27/additional-things-i-learned-from-jquery-source/">Additional Things I Learned From jQuery Source</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-10-27T17:03:00-07:00" pubdate data-updated="true">Oct 27<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Introduction</h2>

<p>Several months ago I decided to build a client side library called <a href="https://github.com/radialglo/guac">Guac</a>.
The library supports a similar and trimmed down API of that of <a href="http://jquery.com/">jQuery</a>.
My library is by no means production ready, but building it was a good exercise for me to also explore
the internals of <a href="https://github.com/jquery/jquery">jQuery</a>.</p>

<p>This posts will discuss some  of the internal workings of jQuery and explain how these
ideas relate to the higher level API of jQuery.
I will be walking you through parts of the <a href="https://github.com/jquery/jquery">jQuery codebase</a>.</p>

<p>I would also recommend taking a look at <a href="http://www.paulirish.com/">Paul Irish&#8217;s</a> related posts:
<a href="http://www.paulirish.com/2010/10-things-i-learned-from-the-jquery-source/">10 Things I learned From jQuery Source</a>
and <a href="http://www.paulirish.com/2011/11-more-things-i-learned-from-the-jquery-source/">11 More Things I learned From jQuery source</a>.
Here is also a <a href="https://gist.github.com/chitsaou/4283482">github gist</a> that summarizes those videos.
I try not to overlap with ideas he has already explained unless they are crucial to what I am discussing below.</p>

<p>At the time of this writing, the version of jQuery I am exploring is <strong>v2.1.1</strong>.</p>

<h2>How the development modules are structured</h2>

<p>From a development perspective jQuery is broken down into a bunch
of modules.</p>

<p>These modules are defined using the <strong>Asynchronous Module Definition</strong> <a href="https://github.com/amdjs/amdjs-api/wiki/AMD">AMD</a>
specification.</p>

<p>The main file of jQuery is <a href="https://github.com/jquery/jquery/blob/master/src/jquery.js">src/jquery.js</a>
and its relevant dependencies are listed as the array in the define function.</p>

<figure class='code'><figcaption><span>AMD Definition for jQuery  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">define</span><span class="p">([</span>
</span><span class='line'>    <span class="s2">&quot;./core&quot;</span><span class="p">,</span> <span class="c1">// refers to ./core.js</span>
</span><span class='line'>    <span class="s2">&quot;./selector&quot;</span><span class="p">,</span> <span class="c1">// refers to ./selector.js</span>
</span><span class='line'>    <span class="c1">// .. more dependencies</span>
</span><span class='line'><span class="p">],</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">jQuery</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'><span class="k">return</span> <span class="nx">jQuery</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>This way of defining modules is crucial to how these modules are
built.
As we will discuss <a href="http://requirejs.org/">requirejs</a> is used to resolve dependencies
and load related modules/files.</p>

<p><strong>Source:</strong><a href="https://github.com/jquery/jquery/blob/master/src/jquery.js#L1-L37">src/jquery.js</a></p>

<h2>How jQuery is built</h2>

<p>The <a href="https://github.com/jquery/jquery#how-to-build-your-own-jquery">README.md for jQuery</a>
describes at a high level how the jQuery source is built.
In particular you will need the <a href="https://www.npmjs.org/">npm</a>
and <a href="http://gruntjs.com/getting-started">grunt</a>. Grunt is a task runner
which allows you to automate repetitive tasks from the command line.
Grunt also provides a development API, which jQuery uses.
In the development directory there is a related <a href="https://github.com/jquery/jquery/blob/master/Gruntfile.js">Gruntfile</a>
that is read when <code>grunt</code> is ran on the command line.
After you install npm and grunt you can build jQuery by running <code>npm install &amp;&amp; grunt</code>.
I&#8217;m going to focus on the lower levels on how jQuery is built.</p>

<p>jQuery uses <a href="http://requirejs.org/">requirejs</a> to build out jQuery by running <a href="http://requirejs.org/docs/node.html">requirejs as a node module</a>
The files that are responsible for building jQuery are stored in the directory <a href="https://github.com/jquery/jquery/tree/master/build/tasks">build/tasks</a>.
These are loaded by the Gruntfile:</p>

<figure class='code'><figcaption><span>Load Build Tasks  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="c1">// Integrate jQuery specific tasks</span>
</span><span class='line'><span class="nx">grunt</span><span class="p">.</span><span class="nx">loadTasks</span><span class="p">(</span> <span class="s2">&quot;build/tasks&quot;</span> <span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Source:</strong> <a href="https://github.com/jquery/jquery/blob/master/Gruntfile.js#L156">build/tasks</a></p>

<p>The build task is executed when <code>grunt</code> is run on the command line.
This is because grunt runs the default task, which includes building among
another things like checking the JavaScript code quality, minifying the source for distribution,
and comparing file size of the current git branch to that of master.</p>

<figure class='code'><figcaption><span>default grunt task  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="c1">// Short list as a high frequency watch task</span>
</span><span class='line'><span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span> <span class="s2">&quot;dev&quot;</span><span class="p">,</span> <span class="p">[</span> <span class="s2">&quot;build:*:*&quot;</span><span class="p">,</span> <span class="s2">&quot;lint&quot;</span> <span class="p">]</span> <span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="p">[</span> <span class="s2">&quot;jsonlint&quot;</span><span class="p">,</span> <span class="s2">&quot;dev&quot;</span><span class="p">,</span> <span class="s2">&quot;uglify&quot;</span><span class="p">,</span> <span class="s2">&quot;dist:*&quot;</span><span class="p">,</span> <span class="s2">&quot;compare_size&quot;</span> <span class="p">]</span> <span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Source Code:</strong> <a href="https://github.com/jquery/jquery/blob/master/Gruntfile.js#L160-L164">register default grunt task</a></p>

<p>The relevant configuration for the tasks are also stored in the Gruntfile
as a JavaScript object.</p>

<figure class='code'><figcaption><span>Grunt Configuration for build  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">build</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">all</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">dest</span><span class="o">:</span> <span class="s2">&quot;dist/jquery.js&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">minimum</span><span class="o">:</span> <span class="p">[</span>
</span><span class='line'>            <span class="s2">&quot;core&quot;</span><span class="p">,</span>
</span><span class='line'>            <span class="s2">&quot;selector&quot;</span>
</span><span class='line'>        <span class="p">],</span>
</span><span class='line'>        <span class="c1">// Exclude specified modules if the module matching the key is removed</span>
</span><span class='line'>        <span class="nx">removeWith</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">ajax</span><span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;manipulation/_evalUrl&quot;</span><span class="p">,</span> <span class="s2">&quot;event/ajax&quot;</span> <span class="p">],</span>
</span><span class='line'>            <span class="nx">callbacks</span><span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;deferred&quot;</span> <span class="p">],</span>
</span><span class='line'>            <span class="nx">css</span><span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;effects&quot;</span><span class="p">,</span> <span class="s2">&quot;dimensions&quot;</span><span class="p">,</span> <span class="s2">&quot;offset&quot;</span> <span class="p">],</span>
</span><span class='line'>            <span class="nx">sizzle</span><span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;css/hiddenVisibleSelectors&quot;</span><span class="p">,</span> <span class="s2">&quot;effects/animatedSelector&quot;</span> <span class="p">]</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Source:</strong> <a href="https://github.com/jquery/jquery/blob/master/Gruntfile.js#L33-L48">grunt build configuration</a></p>

<p><a href="https://github.com/jquery/jquery/blob/master/build/tasks/build.js">build/tasks/build.js</a>
registers a <a href="http://gruntjs.com/api/grunt.task#grunt.task.registermultitask">multitask</a> called <code>build</code>
that iterates over all targets of build if none are specified when built is run on the command line: <code>grunt build</code>.</p>

<figure class='code'><figcaption><span>register multitask </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">grunt</span><span class="p">.</span><span class="nx">registerMultiTask</span><span class="p">(</span>
</span><span class='line'>        <span class="s2">&quot;build&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;Concatenate source, remove sub AMD definitions, &quot;</span> <span class="o">+</span>
</span><span class='line'>            <span class="s2">&quot;(include/exclude modules with +/- flags), embed date/version&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>            <span class="c1">// ...</span>
</span><span class='line'>        <span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Source Code:</strong> <a href="https://github.com/jquery/jquery/blob/master/build/tasks/build.js#L101-L104">build/tasks register build tasks</a></p>

<p>The important line in <a href="https://github.com/jquery/jquery/blob/master/build/tasks/build.js#L270">build.js</a>
is <code>requirejs.optimize(config, function( response ) { ...</code>
that uses requirejs&#8217; optimize as function to build out the file.</p>

<p>The configuration config that is passed to require.js optimize is also important to take a look at.
A more detailed definition of these options is available <a href="https://github.com/jrburke/r.js/blob/master/build/example.build.js">here</a>.</p>

<figure class='code'><figcaption><span>configuration for requirejs.optimize build for jQuery </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">config</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">baseUrl</span><span class="o">:</span> <span class="s2">&quot;src&quot;</span><span class="p">,</span> <span class="c1">// all modules are located relative to this path</span>
</span><span class='line'>    <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;jquery&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">out</span><span class="o">:</span> <span class="s2">&quot;dist/jquery.js&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="c1">// We have multiple minify steps</span>
</span><span class='line'>    <span class="nx">optimize</span><span class="o">:</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="c1">// Include dependencies loaded with require</span>
</span><span class='line'>    <span class="nx">findNestedDependencies</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>    <span class="c1">// Avoid breaking semicolons inserted by r.js</span>
</span><span class='line'>    <span class="nx">skipSemiColonInsertion</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>    <span class="c1">// these files are used to prepend and append </span>
</span><span class='line'>    <span class="c1">// to optimized response</span>
</span><span class='line'>    <span class="nx">wrap</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">startFile</span><span class="o">:</span> <span class="s2">&quot;src/intro.js&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">endFile</span><span class="o">:</span> <span class="s2">&quot;src/outro.js&quot;</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="c1">// we map the &quot;sizzle&quot; module to its actual source</span>
</span><span class='line'>    <span class="nx">paths</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">sizzle</span><span class="o">:</span> <span class="s2">&quot;../external/sizzle/dist/sizzle&quot;</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nx">rawText</span><span class="o">:</span> <span class="p">{},</span>
</span><span class='line'>    <span class="c1">// A function that will be called for every write to an optimized bundle</span>
</span><span class='line'>    <span class="c1">// of modules. This allows transforms of the content before serialization.</span>
</span><span class='line'>    <span class="c1">// convert does the heavy lifting on massaging the files :  mainly stripping out the definitions generated by requirejs</span>
</span><span class='line'>    <span class="nx">onBuildWrite</span><span class="o">:</span> <span class="nx">convert</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>An important property to note is the property <strong>onBuildWrite</strong> and the function <strong>convert</strong> which
is a callback that is invoked with the library is built.
 In particular convert  mainly strips out the definitions generated by requirejs.</p>

<p>The optimized contents are then passed to the <code>config.out</code> function
which will handle writing the text to the relevant destination.</p>

<figure class='code'><figcaption><span>jQuery&#8217;s config.out  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>    <span class="cm">/**</span>
</span><span class='line'><span class="cm">    * Handle Final output from the optimizer</span>
</span><span class='line'><span class="cm">    * @param {String} compiled</span>
</span><span class='line'><span class="cm">    */</span>
</span><span class='line'>    <span class="nx">config</span><span class="p">.</span><span class="nx">out</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">compiled</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">compiled</span> <span class="o">=</span> <span class="nx">compiled</span>
</span><span class='line'>        <span class="c1">// Embed Version</span>
</span><span class='line'>        <span class="p">.</span><span class="nx">replace</span><span class="p">(</span> <span class="sr">/@VERSION/g</span><span class="p">,</span> <span class="nx">version</span> <span class="p">)</span>
</span><span class='line'>        <span class="c1">// Embed Date</span>
</span><span class='line'>        <span class="c1">// yyyy-mm-ddThh:mmZ</span>
</span><span class='line'>        <span class="p">.</span><span class="nx">replace</span><span class="p">(</span> <span class="sr">/@DATE/g</span><span class="p">,</span> <span class="p">(</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()</span> <span class="p">).</span><span class="nx">toISOString</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span> <span class="sr">/:\d+\.\d+Z$/</span><span class="p">,</span> <span class="s2">&quot;Z&quot;</span> <span class="p">)</span> <span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Write concatenated source to file</span>
</span><span class='line'>    <span class="nx">grunt</span><span class="p">.</span><span class="nx">file</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">compiled</span> <span class="p">);</span>
</span><span class='line'>    <span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Source Code:</strong><a href="https://github.com/jquery/jquery/blob/master/build/tasks/build.js#L245-L259">build/tasks/build.js config.out</a></p>

<p>Lastly there is another task called <a href="https://github.com/jquery/jquery/blob/master/build/tasks/build.js#L287">custom</a> that handles the custom exclusion/inclusion
of certain modules.</p>

<h2>jQuery Alias</h2>

<p> You&#8217;re probably familiar <code>$</code> variable which is often used for <a href="http://learn.jquery.com/using-jquery-core/selecting-elements/">selecting DOM Elements</a>
 like so <code>$("#awesomeID")</code></p>

<p> In fact, the <code>$</code> is  actual just an alias for <code>jQuery</code>, so you can also use <code>jQuery("#awesomeID")</code>
 instead of <code>$("#awesomeID")</code>.</p>

<p>The related <a href="https://github.com/jquery/jquery/blob/master/src/exports/global.js#L28">line</a> within the codebase is</p>

<figure class='code'><figcaption><span>jQuery aliasing  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nb">window</span><span class="p">.</span><span class="nx">jQuery</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Source Code:</strong> <a href="https://github.com/jquery/jquery/blob/master/src/exports/global.js">src/exports/global.js</a></p>

<p>Variables at the global scope are automatically attached to the <code>window</code> object. Similarly if you want to create a global from
a variable from an inner scope, add it to the window object.</p>

<p>Since the jQuery codebase is encapsulated in an <a href="http://benalman.com/news/2010/11/immediately-invoked-function-expression/">IIFE</a>
to avoid polluting the global namespace, <code>jQuery</code> and <code>$</code> are attached to the window object to export
it as a global.</p>

<figure class='code'><figcaption><span>Export jQuery and $ to Global Scope  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="c1">// Immediately Invoked Function Expression (IIFE) to encapsulate code base</span>
</span><span class='line'>    <span class="c1">// ...</span>
</span><span class='line'>    <span class="nb">window</span><span class="p">.</span><span class="nx">jQuery</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">;</span> <span class="c1">// create alias and export global variables</span>
</span><span class='line'>    <span class="c1">// ...</span>
</span><span class='line'><span class="p">})();</span>
</span></code></pre></td></tr></table></div></figure>


<p>Please also note that other libraries such as <a href="http://prototypejs.org/">prototype</a> do also use
<code>$</code> as a variable, so if you are using  <code>$</code> in jQuery and other libraries refer to
jQuery&#8217;s documentation on <a href="http://learn.jquery.com/using-jquery-core/avoid-conflicts-other-libraries/">avoiding conflicts with other libraries</a>.</p>

<h2>Prototype Alias</h2>

<p>If you&#8217;ve ever tried creating your own <a href="http://learn.jquery.com/plugins/basic-plugin-creation/">jQuery plugin</a>
you&#8217;ll notice that you add the plugin to <code>$.fn</code>.</p>

<p>As an example for <a href="http://learn.jquery.com/plugins/basic-plugin-creation/">jQuery&#8217;s plugin tutorial</a>,
creating a plugin called <code>greenify</code> that makes retrieved text green would work like so:</p>

<figure class='code'><figcaption><span>jQuery example plugin: greenify  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>    <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">greenify</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">this</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span> <span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span> <span class="p">);</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">(</span> <span class="s2">&quot;a&quot;</span> <span class="p">).</span><span class="nx">greenify</span><span class="p">();</span> <span class="c1">// Makes all the links green.</span>
</span></code></pre></td></tr></table></div></figure>


<p>In fact creating a plugin actually attaches greenify to jQuery&#8217;s <code>prototype</code>, because <code>$.fn</code> is an alias for prototype.
Recall that an object inherit methods and properties from their <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Inheritance_and_the_prototype_chain">prototype</a>.
Since, your plugin is attached to the prototype, you can invoke the plugin after creating your jQuery instance.</p>

<p>The <a href="https://github.com/jquery/jquery/blob/master/src/core.js#L39">related line</a> that creates this aliasing is as follows:</p>

<figure class='code'><figcaption><span>jQuery.prototype aliasing  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// ...</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Source Code:</strong> <a href="https://github.com/jquery/jquery/blob/master/src/core.js#L39">src/core.js</a></p>

<p>Just to verify that jQuery.fn is indeed an alias for jQuery.prototype, we can check that
their memory addresses are equal.</p>

<figure class='code'><figcaption><span>verify jQuery.fn is an alias for jQuery.prototype  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span> <span class="o">===</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">prototype</span> <span class="c1">// true</span>
</span></code></pre></td></tr></table></div></figure>


<p>Using <code>fn</code> as an alias for <code>prototype</code> is a very convenient shorthand.
I believe <code>fn</code> (function) also makes sense semantically because when you
are creating a plugin, you are essentially adding another method to the jQuery Object.</p>

<h2>Method Chaining</h2>

<p>Many of jQuery&#8217;s methods return <code>this</code> (referring to the jQuery instance)</p>

<p>For example <strong>addClass</strong></p>

<figure class='code'><figcaption><span>addClass returns this </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>    <span class="nx">addClass</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">value</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// ...</span>
</span><span class='line'>        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><a href="https://github.com/jquery/jquery/blob/master/src/attributes/classes.js#L10-L52"><strong>Source Code</strong></a></p>

<p>Since <code>this</code> is a reference to the jQuery object, when a method returns <code>this</code>, you
can immediately invoke another method like so:</p>

<figure class='code'><figcaption><span>Method Chaining Example  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.box&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;opacity&quot;</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h2>jQuery Constructor</h2>

<p>Every time you invoke <code>jQuery</code> or <code>$</code>, you are invoking a constructor.
Often times you initialize an object by invoking the constructor with the <code>new</code> keyword.
jQuery hides this by calling <code>new jQuery.fn.init(selector, context)</code> internally, when <code>jQuery</code> is invoked.</p>

<figure class='code'><figcaption><span>jQuery Constructor  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="c1">// Define a local copy of jQuery</span>
</span><span class='line'><span class="nx">jQuery</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">context</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// The jQuery object is actually just the init constructor &#39;enhanced&#39;</span>
</span><span class='line'>    <span class="c1">// Need init if jQuery is called (just allow error to be thrown if not included)</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">context</span> <span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Source Code:</strong> <a href="https://github.com/jquery/jquery/blob/master/src/core.js#L19-L24">src/core.js</a></p>

<p>Since <strong>jQuery.fn.init</strong> is the internal constructor that is used to initialize the jQuery object,
the prototype of init is set to the prototype of jQuery.</p>

<figure class='code'><figcaption><span>Set fn.init.prototype to jQuery.fn </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="c1">// Give the init function the jQuery prototype for later instantiation</span>
</span><span class='line'><span class="nx">init</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// verify that they are indeed equal</span>
</span><span class='line'><span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">init</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">===</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span> <span class="o">&amp;&amp;</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span> <span class="o">===</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">prototype</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Source Code:</strong> <a href="https://github.com/jquery/jquery/blob/master/src/core/init.js#L118-L119">src/core/init.js</a></p>

<h3>Function Overloading</h3>

<p>Many programming languages support a feature known as <a href="http://msdn.microsoft.com/en-us/library/5dhe1hce.aspx"><strong>function overloading</strong></a>  <br/>
which allows for more than one function of the same name in the same scope as long as they differ by certain criteria.
According to this <a href="http://msdn.microsoft.com/en-us/library/5dhe1hce.aspx">function overloading table</a> from Microsoft,
the parts of a function declaration that are used to differentiate between functions within the same scope
include <strong>number of arguments</strong>, <strong>type of arguments</strong>, <strong>presence or absence of ellipsis</strong>  and <strong>const or volatile</strong>.</p>

<p>Although this feature is not explicitly supported in JavaScript, John Resig&#8217;s describe a method for <a href="http://ejohn.org/blog/javascript-method-overloading/">simulating overloading by number of arguments</a>.</p>

<p>jQuery also supports function overloading by checking the type of arguments and the <a href="http://api.jquery.com/jQuery/">jQuery() documentation</a>
discusses such usage in more detail.</p>

<p>Notice the <strong>// HANDLE </strong> comments within the source code
that account for all the different cases.</p>

<figure class='code'><figcaption><span>jQuery.fn.init  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">init</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">context</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">match</span><span class="p">,</span> <span class="nx">elem</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// HANDLE: $(&quot;&quot;), $(null), $(undefined), $(false)</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">selector</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// Handle HTML strings</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span> <span class="k">typeof</span> <span class="nx">selector</span> <span class="o">===</span> <span class="s2">&quot;string&quot;</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">if</span> <span class="p">(</span> <span class="nx">selector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">&amp;&amp;</span>
</span><span class='line'>                <span class="nx">selector</span><span class="p">[</span> <span class="nx">selector</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">]</span> <span class="o">===</span> <span class="s2">&quot;&gt;&quot;</span> <span class="o">&amp;&amp;</span>
</span><span class='line'>                <span class="nx">selector</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;=</span> <span class="mi">3</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>                <span class="c1">// Assume that strings that start and end with &lt;&gt; are HTML and skip the regex check</span>
</span><span class='line'>                <span class="nx">match</span> <span class="o">=</span> <span class="p">[</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="kc">null</span> <span class="p">];</span>
</span><span class='line'>
</span><span class='line'>            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">match</span> <span class="o">=</span> <span class="nx">rquickExpr</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span> <span class="nx">selector</span> <span class="p">);</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">// Match html or make sure no context is specified for #id</span>
</span><span class='line'>            <span class="k">if</span> <span class="p">(</span> <span class="nx">match</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">||</span> <span class="o">!</span><span class="nx">context</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>                <span class="c1">// HANDLE: $(html) -&gt; $(array)</span>
</span><span class='line'>                <span class="k">if</span> <span class="p">(</span> <span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                    <span class="nx">context</span> <span class="o">=</span> <span class="nx">context</span> <span class="k">instanceof</span> <span class="nx">jQuery</span> <span class="o">?</span> <span class="nx">context</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">:</span> <span class="nx">context</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>                    <span class="c1">// Option to run scripts is true for back-compat</span>
</span><span class='line'>                    <span class="c1">// Intentionally let the error be thrown if parseHTML is not present</span>
</span><span class='line'>                    <span class="nx">jQuery</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">parseHTML</span><span class="p">(</span>
</span><span class='line'>                        <span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
</span><span class='line'>                        <span class="nx">context</span> <span class="o">&amp;&amp;</span> <span class="nx">context</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">?</span> <span class="nx">context</span><span class="p">.</span><span class="nx">ownerDocument</span> <span class="o">||</span> <span class="nx">context</span> <span class="o">:</span> <span class="nb">document</span><span class="p">,</span>
</span><span class='line'>                        <span class="kc">true</span>
</span><span class='line'>                    <span class="p">)</span> <span class="p">);</span>
</span><span class='line'>
</span><span class='line'>                    <span class="c1">// HANDLE: $(html, props)</span>
</span><span class='line'>                    <span class="k">if</span> <span class="p">(</span> <span class="nx">rsingleTag</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span> <span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isPlainObject</span><span class="p">(</span> <span class="nx">context</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                        <span class="k">for</span> <span class="p">(</span> <span class="nx">match</span> <span class="k">in</span> <span class="nx">context</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                            <span class="c1">// Properties of context are called as methods if possible</span>
</span><span class='line'>                            <span class="k">if</span> <span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span> <span class="k">this</span><span class="p">[</span> <span class="nx">match</span> <span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                                <span class="k">this</span><span class="p">[</span> <span class="nx">match</span> <span class="p">](</span> <span class="nx">context</span><span class="p">[</span> <span class="nx">match</span> <span class="p">]</span> <span class="p">);</span>
</span><span class='line'>
</span><span class='line'>                            <span class="c1">// ...and otherwise set as attributes</span>
</span><span class='line'>                            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                                <span class="k">this</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span> <span class="nx">match</span><span class="p">,</span> <span class="nx">context</span><span class="p">[</span> <span class="nx">match</span> <span class="p">]</span> <span class="p">);</span>
</span><span class='line'>                            <span class="p">}</span>
</span><span class='line'>                        <span class="p">}</span>
</span><span class='line'>                    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>                    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>                <span class="c1">// HANDLE: $(#id)</span>
</span><span class='line'>                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                    <span class="nx">elem</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span> <span class="nx">match</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">);</span>
</span><span class='line'>
</span><span class='line'>                    <span class="c1">// Support: Blackberry 4.6</span>
</span><span class='line'>                    <span class="c1">// gEBID returns nodes no longer in the document (#6963)</span>
</span><span class='line'>                    <span class="k">if</span> <span class="p">(</span> <span class="nx">elem</span> <span class="o">&amp;&amp;</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">parentNode</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                        <span class="c1">// Inject the element directly into the jQuery object</span>
</span><span class='line'>                        <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>                        <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">elem</span><span class="p">;</span>
</span><span class='line'>                    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>                    <span class="k">this</span><span class="p">.</span><span class="nx">context</span> <span class="o">=</span> <span class="nb">document</span><span class="p">;</span>
</span><span class='line'>                    <span class="k">this</span><span class="p">.</span><span class="nx">selector</span> <span class="o">=</span> <span class="nx">selector</span><span class="p">;</span>
</span><span class='line'>                    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">// HANDLE: $(expr, $(...))</span>
</span><span class='line'>            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">context</span> <span class="o">||</span> <span class="nx">context</span><span class="p">.</span><span class="nx">jquery</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">return</span> <span class="p">(</span> <span class="nx">context</span> <span class="o">||</span> <span class="nx">rootjQuery</span> <span class="p">).</span><span class="nx">find</span><span class="p">(</span> <span class="nx">selector</span> <span class="p">);</span>
</span><span class='line'>
</span><span class='line'>            <span class="c1">// HANDLE: $(expr, context)</span>
</span><span class='line'>            <span class="c1">// (which is just equivalent to: $(context).find(expr)</span>
</span><span class='line'>            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span> <span class="nx">context</span> <span class="p">).</span><span class="nx">find</span><span class="p">(</span> <span class="nx">selector</span> <span class="p">);</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// HANDLE: $(DOMElement)</span>
</span><span class='line'>        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="nx">selector</span><span class="p">.</span><span class="nx">nodeType</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">this</span><span class="p">.</span><span class="nx">context</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">selector</span><span class="p">;</span>
</span><span class='line'>            <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>            <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// HANDLE: $(function)</span>
</span><span class='line'>        <span class="c1">// Shortcut for document ready</span>
</span><span class='line'>        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span> <span class="nx">selector</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">return</span> <span class="nx">rootjQuery</span><span class="p">.</span><span class="nx">ready</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="o">?</span>
</span><span class='line'>                <span class="nx">rootjQuery</span><span class="p">.</span><span class="nx">ready</span><span class="p">(</span> <span class="nx">selector</span> <span class="p">)</span> <span class="o">:</span>
</span><span class='line'>                <span class="c1">// Execute immediately if ready is not present</span>
</span><span class='line'>                <span class="nx">selector</span><span class="p">(</span> <span class="nx">jQuery</span> <span class="p">);</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span> <span class="nx">selector</span><span class="p">.</span><span class="nx">selector</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">this</span><span class="p">.</span><span class="nx">selector</span> <span class="o">=</span> <span class="nx">selector</span><span class="p">.</span><span class="nx">selector</span><span class="p">;</span>
</span><span class='line'>            <span class="k">this</span><span class="p">.</span><span class="nx">context</span> <span class="o">=</span> <span class="nx">selector</span><span class="p">.</span><span class="nx">context</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">makeArray</span><span class="p">(</span> <span class="nx">selector</span><span class="p">,</span> <span class="k">this</span> <span class="p">);</span>
</span><span class='line'>    <span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Source Code:</strong> <a href="https://github.com/jquery/jquery/blob/master/src/core/init.js#L16-L116">src/core/init.js</a></p>

<h3>jQuery&#8217;s Array-like properties</h3>

<p>An interesting feature of the jQuery is that <strong>instances
have Array like properties</strong> as each instance
has a <strong>length property</strong> and stores its elements in <strong>numeric
indices</strong> for its elements.</p>

<p>Here is a sample of properties from a jQuery object:</p>

<figure class='code'><figcaption><span>Array-like properties from jQuery object  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="mi">0</span><span class="o">:</span> <span class="nx">div</span><span class="p">.</span><span class="nx">box</span><span class="p">,</span>
</span><span class='line'>    <span class="mi">1</span><span class="o">:</span> <span class="nx">div</span><span class="p">.</span><span class="nx">box</span><span class="p">,</span>
</span><span class='line'>    <span class="mi">2</span><span class="o">:</span> <span class="nx">div</span><span class="p">.</span><span class="nx">box</span><span class="p">,</span>
</span><span class='line'>    <span class="mi">3</span><span class="o">:</span> <span class="nx">div</span><span class="p">.</span><span class="nx">box</span><span class="p">,</span>
</span><span class='line'>    <span class="mi">4</span><span class="o">:</span> <span class="nx">div</span><span class="p">.</span><span class="nx">box</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">length</span><span class="o">:</span> <span class="mi">5</span>
</span><span class='line'>    <span class="c1">// ...</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>jQuery&#8217;s Array-like behavior meshes well with method chaining,
because for methods that return <code>this</code> or the instance,
you now have the option to not only call another instance method
but also to access selected elements.</p>

<figure class='code'><figcaption><span>Method Chaining and jQuery&#8217;s Array-like properties </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="c1">// Assume we have html divs with a box class</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// we can call a method after the constructor returns</span>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.box&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// we can access an element</span>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.box&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">// get the first box</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// we can chain methods to gether</span>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.box&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;opacity&quot;</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// add class to all boxes and get the first elemeent</span>
</span><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.box&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p>jQuery also has an instance method called <a href="http://api.jquery.com/get/">get</a>
that retrieves the elements matched from jQuery,
using the array like properties we discussed above.</p>

<p>Note that this is different static <a href="http://api.jquery.com/jquery.get/">jQuery.get</a>
that is used to load data from the server with a HTTP GET request.</p>

<figure class='code'><figcaption><span>jQuery.fn.get   </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="c1">// Get the Nth element in the matched element set OR</span>
</span><span class='line'><span class="c1">// Get the whole matched element set as a clean array</span>
</span><span class='line'><span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">num</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">num</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">?</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// Return just the one element from the set</span>
</span><span class='line'>        <span class="p">(</span> <span class="nx">num</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="k">this</span><span class="p">[</span> <span class="nx">num</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="p">]</span> <span class="o">:</span> <span class="k">this</span><span class="p">[</span> <span class="nx">num</span> <span class="p">]</span> <span class="p">)</span> <span class="o">:</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// Return all the elements in a clean array</span>
</span><span class='line'>        <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="k">this</span> <span class="p">);</span>
</span><span class='line'><span class="p">},</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Source Code:</strong> <a href="https://github.com/jquery/jquery/blob/master/src/core.js#L55-L65">src/core.js</a></p>

<h3>Constuctor Walkthroughs</h3>

<p>Now we&#8217;ll discuss a few applications/internals of the jQuery constructor.
For a more detailed view of the meat of the constructor
refer to <a href="https://github.com/jquery/jquery/blob/master/src/core/init.js#L16-L116">src/core/init</a>.</p>

<p>First of all if nothing is passed to the constructor,
the current instance is simply returned.</p>

<figure class='code'><figcaption><span>falsy values passed to jQuery constuctor  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="c1">// HANDLE: $(&quot;&quot;), $(null), $(undefined), $(false)</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">selector</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Source Code:</strong> <a href="https://github.com/jquery/jquery/blob/10399ddcf8a239acc27bdec9231b996b178224d3/src/core/init.js#L19-L22">src/core/init.js</a></p>

<p>Next the constructor  handles strings.
At first the function checks if the string contains brackets
and then uses a regex expression to check whether or not the
string matches html or contains an id.</p>

<p>The regex expression is called <code>rquickExpr</code>.</p>

<figure class='code'><figcaption><span>rquickExpr  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="c1">// A simple way to check for HTML strings</span>
</span><span class='line'><span class="c1">// Prioritize #id over &lt;tag&gt; to avoid XSS via location.hash (#9521)</span>
</span><span class='line'><span class="c1">// Strict HTML recognition (#11290: must start with &lt;)</span>
</span><span class='line'><span class="nx">rquickExpr</span> <span class="o">=</span> <span class="sr">/^(?:\s*(&lt;[\w\W]+&gt;)[^&gt;]*|#([\w-]*))$/</span><span class="p">,</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Source</strong> <a href="https://github.com/jquery/jquery/blob/master/src/core/init.js#L11-L13">src/core/init</a></p>

<p>The example I will first be discussing is a simple
selection for a class.</p>

<h4>1. Select selector</h4>

<figure class='code'><figcaption><span>Find selector </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.box&quot;</span><span class="p">)</span> <span class="c1">// find all elements with the box class</span>
</span></code></pre></td></tr></table></div></figure>


<p>Since this selector will not match the regex described above,
the search will the constructor will invoke <code>jQuery.fn.find</code>
to locate the search the document for the relevant elements</p>

<figure class='code'><figcaption><span>invoke jQuery.fn.find  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="c1">// HANDLE: $(expr, $(...))</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(...)</span> <span class="p">{</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nx">context</span> <span class="o">||</span> <span class="nx">context</span><span class="p">.</span><span class="nx">jquery</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="p">(</span> <span class="nx">context</span> <span class="o">||</span> <span class="nx">rootjQuery</span> <span class="p">).</span><span class="nx">find</span><span class="p">(</span> <span class="nx">selector</span> <span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is the function definition for <code>jQuery.fn.find</code>.</p>

<figure class='code'><figcaption><span>jQuery.fn.find  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">jQuery</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
</span><span class='line'>    <span class="nx">find</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">selector</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">len</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">ret</span> <span class="o">=</span> <span class="p">[],</span>
</span><span class='line'>            <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span> <span class="k">typeof</span> <span class="nx">selector</span> <span class="o">!==</span> <span class="s2">&quot;string&quot;</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">pushStack</span><span class="p">(</span> <span class="nx">jQuery</span><span class="p">(</span> <span class="nx">selector</span> <span class="p">).</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">for</span> <span class="p">(</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                    <span class="k">if</span> <span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span> <span class="nx">self</span><span class="p">[</span> <span class="nx">i</span> <span class="p">],</span> <span class="k">this</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>                    <span class="p">}</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>            <span class="p">})</span> <span class="p">);</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">for</span> <span class="p">(</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">jQuery</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">self</span><span class="p">[</span> <span class="nx">i</span> <span class="p">],</span> <span class="nx">ret</span> <span class="p">);</span> <span class="c1">// invoke sizzle</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// Needed because $( selector, context ) becomes $( context ).find( selector )</span>
</span><span class='line'>        <span class="nx">ret</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">pushStack</span><span class="p">(</span> <span class="nx">len</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">?</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">unique</span><span class="p">(</span> <span class="nx">ret</span> <span class="p">)</span> <span class="o">:</span> <span class="nx">ret</span> <span class="p">);</span>
</span><span class='line'>        <span class="nx">ret</span><span class="p">.</span><span class="nx">selector</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">selector</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">selector</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">selector</span> <span class="o">:</span> <span class="nx">selector</span><span class="p">;</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>We pass a string to jQuery.fn.find and then the static method
jQuery.find is invoked. <a href="https://github.com/jquery/jquery/blob/master/src/selector-sizzle.js#L6">jQuery.find</a>
is really just an alias for <a href="http://sizzlejs.com/">Sizzle</a>, the selector engine.</p>

<p>The results of items found by Sizzle are stored as an array in the <code>ret</code>
variable.</p>

<p>That array is then passed into to the function <code>pushStack</code>
which merges a new instance of jQuery <code>this.constructor</code>
with the current array of matched elements, <code>elements</code>.</p>

<p>As we discussed above, invoking the constructor with no values,
will just immediately return the instance of jQuery.</p>

<figure class='code'><figcaption><span>jQuery.pushStack  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>    <span class="c1">// Take an array of elements and push it onto the stack</span>
</span><span class='line'>    <span class="c1">// (returning the new matched element set)</span>
</span><span class='line'>    <span class="nx">pushStack</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">elems</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// Build a new jQuery matched element set</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">ret</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(),</span> <span class="nx">elems</span> <span class="p">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// Add the old object onto the stack (as a reference)</span>
</span><span class='line'>        <span class="nx">ret</span><span class="p">.</span><span class="nx">prevObject</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'>        <span class="nx">ret</span><span class="p">.</span><span class="nx">context</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// Return the newly-formed element set</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span>
</span><span class='line'>    <span class="p">},</span>
</span></code></pre></td></tr></table></div></figure>


<p>Another important aspect of push stack is that it keeps
reference to the previous object or parent of the search.
This is helpful for methods like <a href="http://api.jquery.com/end/">end</a>
which return the reference to the parent element.</p>

<figure class='code'><figcaption><span>Sample use of jQuery.end  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">$</span><span class="p">(</span> <span class="s2">&quot;ul.first&quot;</span> <span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">find</span><span class="p">(</span> <span class="s2">&quot;.foo&quot;</span> <span class="p">)</span>
</span><span class='line'>        <span class="p">.</span><span class="nx">css</span><span class="p">(</span> <span class="s2">&quot;background-color&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span> <span class="p">)</span> <span class="c1">// update .foo elements</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">end</span><span class="p">()</span> <span class="c1">// return to ul.first</span>
</span><span class='line'><span class="c1">// refer to http://api.jquery.com/end/</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Source:</strong> <a href="https://github.com/jquery/jquery/blob/10399ddcf8a239acc27bdec9231b996b178224d3/src/core.js#L113-L115">jQuery.end</a></p>

<p>jQuery.merge  (used in pushStack) copies over the second array into
the first array. In this case, the elements returned from jQuery&#8217;s
sizzle are copied over to the instance (<code>this</code>).</p>

<p>Notice that this form of merging is consistent
with <strong>jQuery&#8217;s Array-like properties</strong> discussed above.</p>

<figure class='code'><figcaption><span>jQuery.merge  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">merge</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">first</span><span class="p">,</span> <span class="nx">second</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">len</span> <span class="o">=</span> <span class="o">+</span><span class="nx">second</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">i</span> <span class="o">=</span> <span class="nx">first</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">for</span> <span class="p">(</span> <span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">first</span><span class="p">[</span> <span class="nx">i</span><span class="o">++</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">second</span><span class="p">[</span> <span class="nx">j</span> <span class="p">];</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">first</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="nx">first</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Source:</strong> <a href="https://github.com/jquery/jquery/blob/master/src/core.js#L357-L369">src/core.js</a></p>

<h4>2. Build HTML</h4>

<p>If  the content matches the HTML regex describe previously, an array of DOM nodes generated from the parsed html
is merged into the current instance.</p>

<figure class='code'><figcaption><span>Sample for constructing elements with jQuery using html  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;&lt;/div&gt;&quot;</span><span class="p">)</span> <span class="c1">// build a div element</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>parse html in constructor  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">jQuery</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">parseHTML</span><span class="p">(</span>
</span><span class='line'>                    <span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
</span><span class='line'>                    <span class="nx">context</span> <span class="o">&amp;&amp;</span> <span class="nx">context</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">?</span> <span class="nx">context</span><span class="p">.</span><span class="nx">ownerDocument</span> <span class="o">||</span> <span class="nx">context</span> <span class="o">:</span> <span class="nb">document</span><span class="p">,</span>
</span><span class='line'>                    <span class="kc">true</span>
</span><span class='line'><span class="p">));</span>
</span></code></pre></td></tr></table></div></figure>


<h4>3. document.ready</h4>

<p> <code>$(document).ready( handler )</code> is a construct
that is used to invoke the handler when the DOM
has been constructed.</p>

<p>Since document is a DOM element it will simply be stored as element 0 of the instance.</p>

<figure class='code'><figcaption><span>handle DOMElement  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="k">if</span> <span class="p">(</span> <span class="nx">selector</span><span class="p">.</span><span class="nx">nodeType</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">context</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">selector</span><span class="p">;</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Source: </strong> <a href="https://github.com/jquery/jquery/blob/master/src/core/init.js#L96-L98">src/core/init.js</a></p>

<p>Then <a href="https://github.com/jquery/jquery/blob/10399ddcf8a239acc27bdec9231b996b178224d3/src/core/ready.js">jQuery.fn.ready</a>
 is invoked with the callback. An interesting to note is that that invoking <code>.ready</code> does not require any elements
although the <a href="http://api.jquery.com/ready/">api  does not recommend using ready like this</a>: <code>$().ready( handler )</code> (this is not recommened).</p>

<p>There is another shorthand for <code>$(document).ready</code> where you pass
the function to the constructor.</p>

<figure class='code'><figcaption><span>Shorthand document.ready  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>    <span class="nx">$</span><span class="p">(</span> <span class="nx">handler</span> <span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Internally jQuery stores a reference to the document called <code>rootjQuery</code>.
If a function is passed to the constructor, then ready is called on rootjQuery.</p>

<figure class='code'><figcaption><span>rootjQuery  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="c1">// A central reference to the root jQuery(document)</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">rootjQuery</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// ...</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// ...</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Initialize central reference</span>
</span><span class='line'><span class="nx">rootjQuery</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">(</span> <span class="nb">document</span> <span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Source code:</strong> <a href="https://github.com/jquery/jquery/blob/master/src/core/init.js#L122">src/core/init.js</a></p>

<figure class='code'><figcaption><span>Handle: $(function)  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="c1">// ...</span>
</span><span class='line'><span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span> <span class="nx">selector</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">rootjQuery</span><span class="p">.</span><span class="nx">ready</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="o">?</span>
</span><span class='line'>        <span class="nx">rootjQuery</span><span class="p">.</span><span class="nx">ready</span><span class="p">(</span> <span class="nx">selector</span> <span class="p">)</span> <span class="o">:</span>
</span><span class='line'>        <span class="c1">// Execute immediately if ready is not present</span>
</span><span class='line'>        <span class="nx">selector</span><span class="p">(</span> <span class="nx">jQuery</span> <span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// ...</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Source code:</strong> <a href="https://github.com/jquery/jquery/blob/master/src/core/init.js#L103-L107">src/core/init.js</a></p>

<h4>4. $({})</h4>

<p>Finally if the item passed into the constuctor does not match any of these cases (and others not discussed here)
the constructor simply makes an array out of the element passed in.</p>

<figure class='code'><figcaption><span>Example that reaches default case </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>    <span class="nx">$</span><span class="p">({});</span>
</span><span class='line'>    <span class="c1">// returns [{}]</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>default constructor case  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="k">return</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">makeArray</span><span class="p">(</span> <span class="nx">selector</span><span class="p">,</span> <span class="k">this</span> <span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Source code:</strong> <a href="https://github.com/jquery/jquery/blob/master/src/core/init.js#L115">src/core/init</a>.
More on <a href="https://github.com/jquery/jquery/blob/master/src/core.js#L336-L350">makeArray</a>.</p>

<p>Why would use a construct like <code>$({})</code>? Wrapping an object around jQuery allows you
to apply jQuery&#8217;s methods onto the object.</p>

<p><a href="http://benalman.com/">Ben Alman</a> wrote a <a href="https://gist.github.com/cowboy/661855">tiny pub-sub system</a>
using such a construct.</p>

<figure class='code'><figcaption><span>Tiny Pub-Sub by Ben Alman </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/* jQuery Tiny Pub/Sub - v0.7 - 10/27/2011
</span><span class='line'> * http://benalman.com/
</span><span class='line'> * Copyright (c) 2011 "Cowboy" Ben Alman; Licensed MIT, GPL */
</span><span class='line'>
</span><span class='line'>(function($) {
</span><span class='line'>
</span><span class='line'>  var o = $({});
</span><span class='line'>
</span><span class='line'>  $.subscribe = function() {
</span><span class='line'>    o.on.apply(o, arguments);
</span><span class='line'>  };
</span><span class='line'>
</span><span class='line'>  $.unsubscribe = function() {
</span><span class='line'>    o.off.apply(o, arguments);
</span><span class='line'>  };
</span><span class='line'>
</span><span class='line'>  $.publish = function() {
</span><span class='line'>    o.trigger.apply(o, arguments);
</span><span class='line'>  };
</span><span class='line'>
</span><span class='line'>}(jQuery));</span></code></pre></td></tr></table></div></figure>


<p><strong>Source Code</strong> <a href="https://github.com/cowboy/jquery-tiny-pubsub/blob/master/src/tiny-pubsub.js">jquery-tiny-pubsub</a></p>

<h2>Static Methods</h2>

<p>jQuery has <a href="http://en.wikipedia.org/wiki/Method_%28computer_programming%29#Static_methods">static methods</a>
which do not require an instance of jQuery to operate.
Many of these <a href="https://github.com/jquery/jquery/blob/master/src/core.js#L191-L460">methods</a> are utility methods
such as <strong>isArray</strong> or <strong>each</strong>.</p>

<figure class='code'><figcaption><span>Static Method Example: $.each  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">el</span><span class="p">){</span>
</span><span class='line'>   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'><span class="c1">// 1</span>
</span><span class='line'><span class="c1">// 2</span>
</span><span class='line'><span class="c1">// 3</span>
</span></code></pre></td></tr></table></div></figure>


<p>An interesting thing to note is that there are <strong>static methods</strong>
and <strong>instance methods</strong> in the codebase that have the same name.</p>

<p>Many of these instance methods also invoke the static methods
within their definition.</p>

<figure class='code'><figcaption><span>jQuery.fn.each instance method  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="c1">// ...</span>
</span><span class='line'><span class="nx">each</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">args</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">args</span> <span class="p">);</span> <span class="c1">// use static each</span>
</span><span class='line'><span class="p">},</span>
</span><span class='line'><span class="c1">// ...</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Source:</strong> <a href="https://github.com/jquery/jquery/blob/master/src/core.js#L85-L87">jQuery.fn.each</a> <a href="https://github.com/jquery/jquery/blob/master/src/core.js#L278-L326">jQuery.each</a></p>

<figure class='code'><figcaption><span>jQuery.fn.find instance method  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">find</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">selector</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">len</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">ret</span> <span class="o">=</span> <span class="p">[],</span>
</span><span class='line'>        <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// ...</span>
</span><span class='line'>    <span class="k">for</span> <span class="p">(</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">jQuery</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">self</span><span class="p">[</span> <span class="nx">i</span> <span class="p">],</span> <span class="nx">ret</span> <span class="p">);</span> <span class="c1">// use static jQuery.find</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// ...</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Source:</strong> <a href="https://github.com/jquery/jquery/blob/master/src/selector-sizzle.js#L6">jQuery.find</a>  <a href="https://github.com/jquery/jquery/blob/master/src/traversing/findFilter.js#L55-L78">jQuery.fn.find</a></p>

<h2>Implicit Iteration</h2>

<p>Under the hood, many of jQuery&#8217;s methods such
as <code>addClass</code> iterate over all the elements
that were selected, which makes the API very to use
especially for first time coders.</p>

<figure class='code'><figcaption><span>Sample Use Case Implicit Iteration  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.box&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">);</span> <span class="c1">// add red class to all elements that contain the box class</span>
</span></code></pre></td></tr></table></div></figure>


<p>Given our understanding of <strong>static methods</strong> and <strong>jQuery&#8217;s Array-like Properties</strong>,
implementing <strong>implicit iteration</strong> (automatic iteration hidden from the API level)
involves iterating over the <strong>this</strong> object reference that contains all the elements.</p>

<figure class='code'><figcaption><span>Simple Iteration addClass  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="k">for</span> <span class="p">(</span> <span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">elem</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span> <span class="nx">i</span> <span class="p">];</span> <span class="c1">// recall that each element is stored in the this object</span>
</span><span class='line'>    <span class="c1">// ... do some class manipulation for the element</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Source Code:</strong> <a href="https://github.com/jquery/jquery/blob/master/src/attributes/classes.js#L27-L49">src/attributes/classes.js</a></p>

<p>If you are <a href="http://api.jquery.com/addclass/#addClass-function">passing a function to addClass</a>,
jQuery uses the <code>this.fn.each</code> to iterate over the object.
This is because <code>this.fn.each</code> uses <code>jQuery.each</code>
which invokes the function on each element.
So in the inner line of the callback <code>this</code> actually refers to the individual element.</p>

<figure class='code'><figcaption><span>this.each iteration addClass  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="k">if</span> <span class="p">(</span> <span class="nx">jQuery</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span> <span class="nx">value</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nx">j</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// &#39;this&#39; here refers to the individual element.</span>
</span><span class='line'>        <span class="nx">jQuery</span><span class="p">(</span> <span class="k">this</span> <span class="p">).</span><span class="nx">addClass</span><span class="p">(</span> <span class="nx">value</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">className</span> <span class="p">)</span> <span class="p">);</span> <span class="c1">// invoke function and individual method</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Source Code:</strong> <a href="https://github.com/jquery/jquery/blob/master/src/attributes/classes.js#L17-L21">src/attributes/classes.js</a></p>

<p><a href="https://github.com/jquery/jquery/blob/master/src/core.js#L279-L326">More details on jQuery.each</a></p>

<p>I hope this article gives you a good overview of how jQuery is built and certain aspects of the codebase.
Applying these principles I hope you will be at more ease should you choose to further explore jQuery&#8217;s codebase
or write more JavaScript.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/08/07/understanding-the-intuition-of-easing/">Understanding the Intuition of Easing</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-07T00:34:00-07:00" pubdate data-updated="true">Aug 7<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Introduction</h2>

<p>Recently I&#8217;ve been studying motion and I wanted to write a  post regarding what I&#8217;ve learned primarily regarding
easing.</p>

<p>I stumbled upon <a href="http://rachsmith.com/">Rachel Smith&#8217;s</a> <a href="http://codepen.io/rachsmith/blog/lets-talk-about-ease-please">beginner post on easing</a>,
a couple weeks ago which was really eye-opening.
Starting out, these tips were really helpful and spurred more research
on the mechanics and principles of easing.</p>

<p>Some additional resources I would recommend reading are</p>

<ul>
<li><p><a href="http://en.wikipedia.org/wiki/12_basic_principles_of_animation">12 Principles of Animation</a></p>

<ul>
<li>Animation principles written by  Disney animators Ollie Johnston and Frank Thomas</li>
</ul>
</li>
<li><p><a href="http://www.robertpenner.com/easing/penner_chapter7_tweening.pdf">Robert Penner&#8217;s Chapter on Tweening</a></p>

<ul>
<li>If you want learn more about the mechanics for easing, <a href="http://www.robertpenner.com/">Robert Penner</a>, the creator of the easing functions, provides
a good <a href="http://www.robertpenner.com/easing/">set of resources on his site</a>.</li>
</ul>
</li>
<li><p><a href="http://www.google.com/design/spec/animation/authentic-motion.html">Google Design Guidelines regarding motion</a></p>

<ul>
<li>Google&#8217;s comprehensive guide for visual, motion, and interaction design across platforms and devices.</li>
</ul>
</li>
</ul>


<p>Some of the key points to take away from these posts regarding motion in general include</p>

<ol>
<li><strong>Physical objects</strong> have mass and <strong>move only when forces are applied</strong> to them. Consequently, objects can’t start or stop instantaneously. Animation with abrupt starts and stops or rapid changes in direction appears unnatural and can be an unexpected and unpleasant disruption for the user.</li>
<li><strong>Motion with swift acceleration and gentle deceleration feels natural and delightful</strong>.</li>
<li><strong>Enter and exit frame at peak velocity</strong>. This behavior emulates natural movement: a person entering the frame of vision does not begin walking at the edge of the frame but well before it.
  Easing in when entering and slowing down when exiting draw the user&#8217;s attention to that motion, which, in most cases, isn&#8217;t the effect you want.
  Likewise

<ul>
<li>Use <strong>ease-out</strong> to move something <strong>onto</strong> the stage</li>
<li>Use <strong>ease-in</strong> to move something <strong>off</strong> stage</li>
<li>Use <strong>ease-in-out</strong> to move <strong>something</strong> across the stage (from one point to another)</li>
</ul>
</li>
<li><strong>Account for mass.</strong> Lighter/smaller objects may accelerate or decelerate faster, because they have less mass and require less force to do so. Larger/heavier objects may need more time to reach peak speed and come to rest.</li>
</ol>


<p>There are already lots of posts around the web
teaching you how to implement <a href="http://blog.alexmaccaw.com/css-transitions">CSS transitions</a> and
<a href="http://gsgd.co.uk/sandbox/jquery/easing/">use jQuery Easings</a> as well
as <a href="http://easings.net/">tools</a> to <a href="http://matthewlein.com/ceaser/">select</a>
and <a href="http://cubic-bezier.com/#.17,.67,.83,.67">create</a> your own easings.</p>

<p>The purpose of this post is to develop an intuition of easing by:</p>

<ol>
<li><strong>develop an understanding of what easings are and the relationship between
different <a href="http://easings.net/">easings</a></strong></li>
<li><strong>learn how to select/apply easings</strong></li>
<li><strong>examine real world application of easings</strong>
such as on <a href="https://www.flickr.com/">Flickr&#8217;s website</a>
and <a href="http://www.google.com/glass/start/">Google Glass&#8217; website</a>.</li>
</ol>


<h2>Motion and Tweening</h2>

<p>In filmaking, movies or motion pictures can be thought of  as a series of still images or <strong>frames</strong> that
compose a complete <strong>moving picture</strong>.</p>

<p>Likewise in traditional animation, animators would either draw out every single frame
of an animation from start to end with the <strong>straight ahead technique</strong> or draw <strong>keyframes (important
frames of a sequence)</strong> and then generate <strong>intermediate frames</strong> between
the keyframes known as <strong>inbetweens</strong>. The process of generating intermediate frames
between keyframes is also known as <strong>tweening</strong> or interpolating and the resulting sequence of frames
is known as a <strong>tween</strong>.</p>

<p><img src="/images/straight-ahead-pose.jpg" alt="Straight Ahead Pose to Pose" /></p>

<p><em>The top illustrates a straight-ahead technique, while the bottom represents
the keyframes that will be used from pose-to-pose animation</em></p>

<p><a href="http://www.smashingmagazine.com/2012/10/30/motion-and-animation-a-new-mobile-ux-design-material/">Source: Smashing Magazine</a></p>

<p>From a programmatic perspective, <strong>motion</strong> is simply <strong>the numerical
change of position with time</strong>.</p>

<h2>What is easing</h2>

<p><strong>Easing</strong> comes into play because it used to model how <strong>position changes with time</strong>.
<a href="http://www.robertpenner.com/">Robert Penner</a> created a set of <a href="http://www.robertpenner.com/easing/">easing functions</a> to model these positional changes.
Easings are applied to <strong>tweens</strong> to specify the speed at which the animation progresses
at different points within the tween.</p>

<h3>Note on position</h3>

<p>As Robert Penner <a href="http://www.robertpenner.com/easing/penner_chapter7_tweening.pdf">notes</a>,
<strong>position</strong> doesn&#8217;t have be a physical position but can be any one dimensional value
such as <strong>opacity</strong>. Of course you can animate two- and three-dimensional motion
such as area and volume, but these animation are broken down into several
one-dimensional values.</p>

<h2>How to interpret easing graphs</h2>

<p>There is quite a selection of easing functions to choose from, so how do you choose which one works best for you?
Luckily, these easing functions have been visualized as <a href="http://easings.net/">position vs. time graphs</a>, so understanding how to interpret these
graphs is crucial for selecting the right easing. You can also <a href="http://5013.es/toys/tween.audio/">&#8220;listen&#8221;</a> to these easings.<code>Position is the y axis (vertical)</code> and <code>time is the x axis (horizontal)</code>.
For the most part, each axis is bound between 0 and 1 (representing 0 to 100% of position or time),
but as we&#8217;ll see position of easings such as <strong>easeOutBack</strong> can exceed 1 and <strong>easeInBack</strong> can go below 0.
You can also think of the bounds of the y and x axes representing start/end position and start/end time respectively.</p>

<!--
    Physics refresher
-->


<p>As a <a href="http://www.physicsclassroom.com/class/1DKin/Lesson-1/Speed-and-Velocity">physics refresher</a>,
<code>change in position = displacement = (position2 - position1)</code>and <code>average velocity = displacement / time</code>.
Looking at a position vs. time graph, we can <strong>interpret a line or curve as a set of points</strong>. Each point represents a position.
If you take the <strong>slope</strong> between the two points <code>(position2 - position1) / (time2 - time1)</code> then you get the <code>velocity</code> within that time frame.
It also important to remember that <strong>velocity is a vector quantity</strong> meaning that it represents
both a <strong>value and direction</strong> (how fast and in which direction), whereas speed is a scalar quantity only representing a value (how fast). So <code>negative velocity</code>
represents the same speed of an equivalent positive velocity but in the opposite direction.</p>

<p>Finally, if you take the <strong>slope of the velocity graph</strong>, <code>(velocity2 - velocity1) / (time2 - time1)</code> then you get the <code>acceleration</code>.
In other words, <strong>acceleration tells you whether or not the object speeds up or slows down with time and in which direction</strong>.
An acceleration of 0, means that velocity was constant.</p>

<p>The follow graph from <a href="http://hyperphysics.phy-astr.gsu.edu/hbase/mechanics/motgraph.html">here</a>
as displayed below visualizes these concepts well.</p>

<p><img src="/images/motslope.gif" alt="Velocity and Acceleration" /></p>

<p><a href="http://hyperphysics.phy-astr.gsu.edu/hbase/mechanics/motgraph.html">Source: Hyperphysics</a></p>

<p>There are <strong> 4 basic easing functions </strong>:<br/>
1. linear<br/>
2. ease-in<br/>
3. ease-out<br/>
4. ease-in-out</p>

<p>Below we&#8217;ll look at how to interpret these graphs.
I would also recommend playing with this
<a href="http://gilmoreorless.github.io/sydjs-preso-easing/#how-it-works-demo">easing visualization</a>
created by <a href="https://github.com/gilmoreorless">Gilmore Davidson</a> which is where the
following images are adapted from.</p>

<h3>Linear</h3>

<p><img src="/images/linear-easing.png" alt="Linear Easing" /></p>

<p><a href="http://gilmoreorless.github.io/sydjs-preso-easing/#how-it-works-demo">Source: SydJS Easing Presentation</a></p>

<p>The slope of this graph is a constant value, because the line is straight.
A constant velocity means that there is no acceleration.</p>

<h3>Ease-In</h3>

<p><img src="/images/ease-in.png" alt="Ease In" /></p>

<p><a href="http://gilmoreorless.github.io/sydjs-preso-easing/#how-it-works-demo">Source: SydJS Easing Presentation</a></p>

<p>The slope of this graph gets steeper over time meaning that the velocity increases over time.
In other words, the object <strong>starts out slow and accelerates over time</strong>.</p>

<h3>Ease-Out</h3>

<p><img src="/images/ease-out.png" alt="Ease Out" /></p>

<p><a href="http://gilmoreorless.github.io/sydjs-preso-easing/#how-it-works-demo">Source: SydJS Easing Presentation</a></p>

<p>This graph behaves in the opposite manner of an ease-in graph.
The slope of this graph gets flatter over time meaning that the velocity decreases over time.
In other words, the object <strong>starts out fast and decelerates over time</strong>.</p>

<h3>Ease-In-Out</h3>

<p><img src="/images/ease-in-out.png" alt="Ease In-Out" /></p>

<p><a href="http://gilmoreorless.github.io/sydjs-preso-easing/#how-it-works-demo">Source: SydJS Easing Presentation</a></p>

<p>This graph is a combination of an ease-in and ease-out graph.
Looking at the slope, we see that initially the object starts out slow and accelerates over time before hitting a peak velocity,
followed by a gradual deceleration before stopping.</p>

<h2>Different Degrees of Easing</h2>

<p>These &#8220;standard&#8221; easing classes model position as a <a href="http://en.wikipedia.org/wiki/Power_function">power function</a> of <code>time t</code>
raised to some power: Linear - 1, Quad(ratic) - 2, Cubic - 3, Quart(ic) - 4, Quint(ic) - 5.</p>

<p>We&#8217;ll look at these different degrees of easing by examining the <strong>easeIn</strong> curve.
Recall that the bounds for time are between 0 and 1 and that decimal values yield smaller values
when raised to increased powers.</p>

<p><img src="/images/degrees-of-easing.png" alt="Degrees of Easing" /></p>

<p><a href="http://www.robertpenner.com/easing/penner_chapter7_tweening.pdf">Source: Penner</a></p>

<pre><code>Let t = 0.8
    t^2 = 0.64
    t^3 = 0.512
    t^4 = 0.4096
    t^5 = 0.32768
</code></pre>

<p>Since <strong>decimal values yield smaller results decrease with increased power</strong>,
this means that increasing powers exaggerates the easing effect.
In particular for <strong>easeIn</strong> easings, the object remains slower for a longer time and
accelerates faster when it finally speeds up.</p>

<h3>Linear</h3>

<p>Power of 1. Uses Constant Velocity.</p>

<h3>Quad</h3>

<p>Power of 2. Interesting tidbit to distinguish <strong>Quad</strong> from <strong>Quart</strong>: Although the prefix quad means four, quad originally referred to the four sides of a square.
Therefore a <strong>squared</strong> variable is a quadratic.</p>

<h3>Cubic</h3>

<p>Power of 3.</p>

<h3>Quart</h3>

<p>Power of 4.</p>

<h3>Quint</h3>

<p>Power of 5.</p>

<h2>Other Easings</h2>

<h3>Sinusoidal Easing</h3>

<p><img src="/images/sine-easing.png" alt="sinEasing" /></p>

<p><a href="http://www.robertpenner.com/easing/penner_chapter7_tweening.pdf">Source: Penner</a></p>

<p>The position is a function of a sin: <code>p(t) = sin(t * π/2)</code>.
Sinusoidal easing is quite gentle, even more so than quadratic easing.
Its path doesn’t have a lot of curvature. Much of the
curve resembles a straight line angled at 45 degrees, with just a bit of a
curve to it.</p>

<h3>Exponential Easing</h3>

<p>Recall that for an exponential function such as <a href="http://en.wikipedia.org/wiki/Exponential_growth">exponential growth</a>,
<strong>time t is an exponent</strong> 2<sup>t,</sup> whereas in power functions time is a value raised to a constant value for example t<sup>2.</sup>
Generally exponential functions grow faster than power functions and are therefore more exaggerated.</p>

<p><img src="/images/expo-easing.png" alt="exponentialEasing" /></p>

<p><a href="http://www.robertpenner.com/easing/penner_chapter7_tweening.pdf">Source: Penner</a></p>

<h4>History of Exponential Easing</h4>

<p>The Exponential Easing is based off what Robert Penner calls the <strong>standard exponential slide</strong>,
that was used often used in ActionScript, a dialect of ECMAScript used for Flash.</p>

<pre><code>// a standard exponential slide
this.onEnterFrame = function () {
var distance = this.destinationX - this._x;
    this._x += distance / 2;
};
</code></pre>

<p>The idea is simply that you
move a fraction of the distance—say one-half—to your destination in each
unit of time. For instance, if you need to move a total of 10 feet, you could
move 5 feet, then 2.5 feet, then 1.25, then .625, and so on.</p>

<p>Notice that this is a <a href="http://en.wikipedia.org/wiki/Geometric_series">Geometric Series</a>,
which is a sum of a sequence of terms where there is a constant ratio between successive terms.
The sum of a Geometric series is <code>c / (1 - r)</code>, where <strong>c is  constant multiplied to each term</strong> and <strong>r is the ratio between each term</strong>
We can verify the above example: 10 = 5 / (1 - 1/2) where <strong>c = 5 and r = 1 / 2</strong>.</p>

<h3>Circular Easing</h3>

<p><img src="/images/circ-easing.png" alt="Circ Easing" /></p>

<p><a href="http://www.robertpenner.com/easing/penner_chapter7_tweening.pdf">Source: Penner</a></p>

<p>The position is a based of the equation for a half circle: <code>p(t) = 1 - sqrt(1 - t^2)</code>.
This equation is derived from the equation of a <a href="http://en.wikipedia.org/wiki/Unit_circle">unit circle</a> <code>x^2 + y^2 = 1</code>
Solving for <code>y</code>, we get that the upper half of the circle is <code>y = sqrt(1 - x^2)</code>.
Likewise the lower half of the circle is <code>y = -sqrt(1 - x^2)</code>, because negating the equation flips
the graph vertically (over the y axis).
Finally we add 1 to the equation so that the unit circle is shifted up to top <code>y = (-sqrt(1 - x^2)) + 1</code>,
Since the bounds of <code>time &gt; 0</code> our graph is a quarter circle residing in the top right quadrant.
This can be rewritten as <code>y(x) = 1 - sqrt(1 - x^2)</code>.</p>

<p>Similar to quintic and exponential easing, the accleration for circular easing is dramatic, but it also happens
more <strong>suddenly</strong>.
Since the circle exhibits more curvature, we see a greater range of velocity as well as sharper changes towards the
beginning of easeInCirc and at the end of easeOutCirc.</p>

<p>The following diagram displays all easings mentioned so far in juxtaposition,
ordered by roughly increasing curvature/acceleration.</p>

<p><img src="/images/standard-easings.png" alt="Standard Easings" /></p>

<p><a href="http://gilmoreorless.github.io/sydjs-preso-easing/#smooth-curves">Source: SydJS Easing Presentation</a></p>

<h2>Special Effect Easings</h2>

<p>More complex curves have been modeled to create special effects.</p>

<h3>Back</h3>

<p>This easing exceeds the start or end position for easeIn and easeOut respectively, before springing back into place.
The easing displayed below is <strong>easeOutBack</strong>.</p>

<p><img src="/images/easeOutBack.png" alt="easeOutBack" /></p>

<p><a href="http://gilmoreorless.github.io/sydjs-preso-easing/#cemd-anim-back">Source: SydJS Easing Presentation</a></p>

<p data-height="268" data-theme-id="0" data-slug-hash="pFzlJ" data-default-tab="result" class='codepen'>See the Pen <a href='http://codepen.io/radialglo/pen/pFzlJ/'>easeOutBack</a> by Anthony Su (<a href='http://codepen.io/radialglo'>@radialglo</a>) on <a href='http://codepen.io'>CodePen</a>.</p>


<h3>Elastic</h3>

<p>This easing <strong>oscillates</strong> around the  start or end position for easeIn and easeOut respectively.</p>

<p><img src="/images/easeOutElastic.png" alt="easeOutElastic" /></p>

<p><a href="http://gilmoreorless.github.io/sydjs-preso-easing/#cemd-anim-elastic">Source: SydJS Easing Presentation</a></p>

<p data-height="268" data-theme-id="0" data-slug-hash="tnCJi" data-default-tab="result" class='codepen'>See the Pen <a href='http://codepen.io/radialglo/pen/tnCJi/'>easeOutElastic</a> by Anthony Su (<a href='http://codepen.io/radialglo'>@radialglo</a>) on <a href='http://codepen.io'>CodePen</a>.</p>


<h3>Bounce</h3>

<p>The start and end position form boundaries for easeIn and easeOut respectively, whereupon the object bounces.</p>

<p><img src="/images/easeOutBounce.png" alt="easeOutBounce" /></p>

<p><a href="http://gilmoreorless.github.io/sydjs-preso-easing/#cemd-anim-bounce">Source: SydJS Easing Presentation</a></p>

<p data-height="268" data-theme-id="0" data-slug-hash="HspKu" data-default-tab="result" class='codepen'>See the Pen <a href='http://codepen.io/radialglo/pen/HspKu/'>easeOutBounce</a> by Anthony Su (<a href='http://codepen.io/radialglo'>@radialglo</a>) on <a href='http://codepen.io'>CodePen</a>.</p>


<h2>CSS Easing</h2>

<p>Although Robert Penner&#8217;s equations were written originally as functions, many of these functions
can also be used in CSS3 using the <strong>cubic-bezier</strong> <a href="http://www.w3.org/TR/css3-transitions/#transition-timing-function">transition timing function</a>.
These functions have been approximated as cubic <a href="http://en.wikipedia.org/wiki/B%C3%A9zier_curve">bezier curves</a> by <a href="http://matthewlein.com/">Matthew Lein</a>.
For more on bezier curves read this <a href="http://en.wikipedia.org/wiki/B%C3%A9zier_curve">article</a>.
Here is a <a href="http://www.jasondavies.com/animated-bezier/">bezier curve simulation from Jason Davies</a>
and <a href="http://tholman.com/bezier-curve-simulation/">another one by Tim Holman</a>.</p>

<p>A limitation of using cubic bezier curves is that <strong>cubic bezier curves contain at most one peak and one valley</strong>.
So if you want to use an easing that has more than one peak/trough, such as <strong>easeInElastic or easeInOutBounce</strong>
then you must use a JavaScript or some other programmatic implementation of easing.</p>

<!--
    Cubic Bezier Curve: Third order bezier curve
    http://www.jasondavies.com/animated-bezier/
    http://tholman.com/bezier-curve-simulation/
    Cubic bezier can have only one peak and one trough
-->


<h2>How to apply easings</h2>

<p>Generally speaking, <strong>linear motion is often mechanical rather than natural</strong>.
You want to conform to the natural laws of motion so that your animation is believable.</p>

<p>However this does not mean you should completely ignore linear easings
even if your not animating mechanical objects.
Easings don&#8217;t neccesarily need to model <strong>physical position</strong>, but can really
used to model any kind of one dimensional value such as <strong>opacity</strong>.
Similarly some applications of linear easing can be used for creating
camera effects like <strong>zooming</strong> or <strong>panning</strong> when creating a <strong>timelapse</strong>
or the <a href="http://en.wikipedia.org/wiki/Ken_Burns_effect"><strong>Ken Burns Effect</strong></a>
for creating videos with still imagery.</p>

<p>Naturally, your eye will be able to <strong>discern something moving at a slower speed
than something moving at a higher speed</strong>. It&#8217;s no coincidence that slow motion scenes
in action movies also tend to be the most interesting.
As such, enter and exit the stage at peak velocity. Entering and exiting the stage
are less important in comparison to when the object finally halts on stage or
begins to leave the stage, respectively.</p>

<!--
    Linear Animation Examples
    Linear Easing:
    Time Lapse
    Ken Burns Effect
-->


<h3>Timing</h3>

<p>If your just starting out some <a href="https://developers.google.com/web/fundamentals/look-and-feel/animations/choosing-the-right-easing">suggested duration of easings</a>
are</p>

<p><strong>Ease-outs: around 200ms - 500ms.</strong> This gives the eye chance to see the animation, but doesn’t feel obstructive.</p>

<p><strong>Ease-ins: around 200ms - 500ms.</strong> Bear in mind that it will jolt at the end (from the acceleration) and no amount of timing changes will soften that feel.</p>

<p><strong>Bounce or elastic effects: around 800ms - 1200ms.</strong> You need to allow time for the elastic or bounce effect to ‘settle’. Without this extra time the elastic bouncing part of the animation will be really aggressive and unpleasant to the eye.</p>

<h3>Car example</h3>

<p>We&#8217;ll be animating a car to understand how to apply easing.</p>

<h4>EaseInOut</h4>

<p>Initially your car starts out <strong>parked</strong>. When you start your car,
you need to push on the pedal to <strong>accelerate</strong> to a comfortable cruising speed
and finally when you are stopping at stop light you <strong>gently decelerate</strong>
so that the ride is comfortable for your passengers.</p>

<p>If you were to witness the full start and stop action of the car you
would see an <strong>easeInOut</strong> easing.
Use <strong>easeInOut</strong> to move something <strong>across</strong> the stage (from one point to another).</p>

<p data-height="268" data-theme-id="0" data-slug-hash="Hnlod" data-default-tab="result" class='codepen'>See the Pen <a href='http://codepen.io/radialglo/pen/Hnlod/'>Car driving across stage</a> by Anthony Su (<a href='http://codepen.io/radialglo'>@radialglo</a>) on <a href='http://codepen.io'>CodePen</a>.</p>


<h4>EaseOut</h4>

<p>Let&#8217;s say you were to see a friend arrive at your house for an evening party.
By the time your friend reaches your house he/she will already be traveling
at peak velocity and will <strong>gently decelerate</strong> before parking in front of your house.
Use <strong>easeOut</strong> to move something <strong>onto</strong> the stage</p>

<p data-height="268" data-theme-id="0" data-slug-hash="FpLHn" data-default-tab="result" class='codepen'>See the Pen <a href='http://codepen.io/radialglo/pen/FpLHn/'>Car driving onto stage</a> by Anthony Su (<a href='http://codepen.io/radialglo'>@radialglo</a>) on <a href='http://codepen.io'>CodePen</a>.</p>


<h4>EaseIn</h4>

<p>After the party, you say goodbye to your friend and watch as his/her car leaves
your neighborhood. Your friend needs to start the parked car
and accelerate to reach a comfortable crusing speed.
By the time the car leaves your field of vision it will be traveling at peak velocity.
Use <strong>easeIn</strong> to move something <strong>off</strong> stage</p>

<p data-height="268" data-theme-id="0" data-slug-hash="tDqbr" data-default-tab="result" class='codepen'>See the Pen <a href='http://codepen.io/radialglo/pen/tDqbr/'>Car backing off stage</a> by Anthony Su (<a href='http://codepen.io/radialglo'>@radialglo</a>) on <a href='http://codepen.io'>CodePen</a>.</p>


<p>Now that you know how to apply easeIn, easeOut, and easeInOut
you can change the power of your easing (Quad, Cubic, Quart &#8230;)
to minimize or exaggerate the effect.</p>

<h2>Easings in the Wild</h2>

<p>Next let&#8217;s examine how easing is being used across the web.</p>

<h3>Flickr</h3>

<p><a href="https://www.flickr.com/">Flickr</a> is built using <a href="https://yuilibrary.com/">YUI</a>, Yahoo User Interface Library,
Yahoo&#8217;s JavaScript framework.
The site currently uses <strong>scroll-jacking</strong>, which is
the process of overriding default user scrolling with a custom
interaction design paradigm.</p>

<p>The user interface also has arrow buttons, bullet lists, and accepts
keyboard input such as space bar / page down, j/k, arrow keys for navigation.</p>

<p>From the source code we can see the handling of keypresses and clicks.
All of these input methods are used to animate the scroll position.</p>

<h4>Keydown Source</h4>

<pre><code>Y.one(document).on('keydown', function(e) {

    var down, up, beginning, end;
    var ignoreMultiple;

    // space bar / page down, j/k, arrow keys
    if (e.keyCode) {
        down = (e.keyCode === 32 || e.keyCode === 34 || e.keyCode === 74 || e.keyCode === 40);
        up = (e.keyCode === 33 || e.keyCode === 75 || e.keyCode === 38);
        beginning = (e.keyCode === 36);
        end = (e.keyCode === 35);
    }

    // ignore if in an input, select/option etc.
    if (!document.activeElement || !document.activeElement.nodeName.match(/(input|select|option)/i)) {

        // block multiple events only for up/down arrow keys.
        if (!down &amp;&amp; !up) {
            ignoreMultiple = true;
        }

        // do the nav thing
        if (down) {
            animateTo('#section-' + getNextSection(), ignoreMultiple);
        } else if (up) {
            animateTo('#section-' + getPreviousSection(), ignoreMultiple);
        } else if (beginning) {
            animateTo('#section-1');
        } else if (end) {
            animateTo('#section-' + maxSections);
        }

        // override default actions
        if (up || down || beginning || end) {
            e.preventDefault();
            return false;
        }

    }

});
</code></pre>

<h4>Click Source</h4>

<pre><code>Y.one('body').on('click', function(e) {

        var target = e.target;
        var href = target.get('href');
        var hash, hashOffset;
        var url;
        var anim;

        if (href) {

            // a #section-x link was clicked.

            if (href.match(/section/i)) {

                hashOffset = href.indexOf('#');

                if (hashOffset !== -1) {
                    hash = href.substr(hashOffset);
                    animateTo(hash);
                    e.preventDefault();
                    return false;
                }

            } else {

                // up/down navigation links.

                if (href.match(/\#down/i)) {

                    animateTo('#section-' + getNextSection());

                    e.preventDefault();
                    return false;

                } else if (href.match(/\#up/i)) {

                    animateTo('#section-' + getPreviousSection());

                    e.preventDefault();
                    return false;

                }

            }

        }

    });
</code></pre>

<p>Reading through the source you&#8217;ll notice the primary function
that we see being used for navigation is <strong>animateTo</strong>.</p>

<p>The primary part of that function is to note initialization of
the <a href="http://yuilibrary.com/yui/docs/api/classes/Anim.html"><strong>YUI Animation Class</strong></a></p>

<pre><code>scrollAnimation = new Y.Anim({
    node: scrollElement,
    to: {
        scrollTop: parseInt(targetY, 10)
    },
    // if existing animation was interrupted, move really fast to indicate responsiveness.
    easing: (interrupted ? 'easeOutStrong' : (scrollAction ? 'easeBoth' : 'easeBothStrong')),
    duration: duration
});
</code></pre>

<p>The JavaScript is animating the <strong>scrollTop</strong> of the document.
Also pay attention to the line where the initialization of the easing property occurs.
Notice how there are actually three forms of easings for navigation:
 <strong>easeBoth</strong> (equivalent to easeInOutQuad), <strong>easeBothStrong</strong> (equivalent to easeInOutQuartic), and
<strong>easeOutStrong</strong> (equivalent to easeOutQuartic).
For additional eases available in <a href="https://yuilibrary.com/">YUI</a>,
refer to the <a href="http://yuilibrary.com/yui/docs/api/classes/Easing.html">Easing Class</a>.</p>

<p>These easing are being used as follows:</p>

<h4>Flickr: Scroll Navigation</h4>

<p><strong>easeBoth</strong></p>

<p><img src="/images/flickr-scroll.gif" alt="Flickr Scroll" /></p>

<ul>
<li><p>If the user <strong>scrolls</strong>, use a easeInOutQuad easing to move to the next section &#8211; start out slow before swift acceleration
followed by gradual deceleration.</p></li>
<li><p>The easing makes sense because there is one section moving off stage (easeIn)
followed by another section moving into view (easeOut). Hence the use of easeBoth.</p></li>
<li><p>One interesting to note is that the transition is a response to the user&#8217;s scrolling.
Because the transition starts out slow, the user may percieve this as a slow responsive website.
The general rule of thumb is to <strong>respond to a user interaction quickly</strong>.
Thus, potentially slow percieved performance is tradeoff when using an <strong>easeInOutQuad</strong> transition to respond to the user.</p></li>
</ul>


<h4>Flickr: Click Navigation</h4>

<p><strong>easeBothStrong</strong></p>

<p><img src="/images/flickr-click.gif" alt="Flickr Click" /></p>

<ul>
<li>For all other forms of input such as <strong>button click</strong> or valid <strong>keypresses</strong>
use a more dramatic easeInOut function: <strong>easeInOutStrong (easeInOutQuartic)</strong>.</li>
<li>It&#8217;s pretty interesting this easing is more exaggerated than that of scrolling.
I think the rational is that because buttons are more custom than native scrolling,
there is more flexibility to define a more dramatic transition.</li>
<li>From my view, I think the easing for scrolling and clicks should be consistent.
At the same I would imagine that users probably stay with one method of navigation
when browsing the site, so the difference could be negligible.</li>
</ul>


<h4>Flickr: Click vs Scroll Comparison</h4>

<p><img src="/images/flickr-click-scroll.gif" alt="Flickr Click Scroll" /></p>

<p>To really compare  <strong>click navigation(easeInOutQuartic)
vs. scroll navigation(easeInOutQuad)</strong>, notice the difference
between the click and scroll when they are performed one after another.
Since the <strong>click(Quartic)</strong> has a higher easing degree than <strong>scroll(Quad)</strong>
the acceleration for the click is more dramatic.
Note that the click occurs first followed by the scroll.</p>

<h4>Flickr: Interrupt Navigation</h4>

<p><strong>easeOutStrong</strong></p>

<p><img src="/images/flickr-interrupt-click.gif" alt="Flickr Interrupt Click" /></p>

<ul>
<li>If the user tries navigating while an animation is in progress (an interrupt)  perform an easeOutQuartic
easing to the next section. (Note from the dots on the right, that we are navigating from slide 1 to 3)</li>
<li>The interaction is defined such that when an interrupt occurs navigate to the newly desired slide.</li>
<li>As such, using <strong>easeOutStrong</strong> makes sense here. Since the currently slide is already moving
it should continue moving at a high velocity before coming to rest.</li>
</ul>


<h4>Flickr: Far Click</h4>

<p><strong>easeBothStrong</strong></p>

<p><img src="/images/flickr-far-click.gif" alt="Flickr Far Click" /></p>

<p>This is the same easing as the click navigation discussed above.
In this example, the user jumps over sections navigating to slide 5 from slide 1 by clicking dot 5.
The difference here is that because the scroll animation occurs over a longer distance
within the same time, the velocity here is greater.</p>

<h3>Google Glass</h3>

<!--
.fade-out
.5s opacity ease

cubic-bezier(.77,0,.175,1)
-->


<p>Next we&#8217;ll look at another implementation of a <strong>scroll-jacked</strong>
website: Google Glass&#8217; <a href="http://www.google.com/glass/start/">start page</a>.</p>

<h4>Google Glass: Click Navigation</h4>

<p><strong>easeInOutQuart</strong></p>

<p><img src="/images/glass-click.gif" alt="Glass Click" /></p>

<p>This site is implemented using CSS3.
The easing that is being used is a <code>cubic-bezier(.77,0,.175,1)</code>, which is <strong>easeInOutQuart</strong>,
and the site makes use of CSS3 transforms to translate to the next slide.
Recall that Flickr does use easeInOutQuart for some of its easing although the transition
here appears to be more pronounced because a larger object(the background image) is being moved.
This site less ways to navigate and does not allow for interrupts.</p>

<p>The gist of creating this effect is to define a state in which the slide is hidden
and a state in which a slide is active and defining how to transition between each state.</p>

<pre><code>/*
    translate 100% of the slide's body to move it offscreen
*/
.slide { 
    transform: translate3d(0,100%,0)
    transition: transform 1s;
    transition-timing-function: cubic-bezier(.77,0,.175,1);
}
/*
    don't translate
    toggling the .active class on a slide will bring the slide into view
*/
.slide.active {
    transform: translate3d(0,0,0)
}
</code></pre>

<h4>Google Glass: Far Click</h4>

<p>The way this site handles skipping over sections is to fade out
the old image and fade in the new image.
It fades out the image using the default transition: <strong>ease</strong>
and then fading back in using the <strong>easeOutQuart</strong> cubic-bezier curve.</p>

<p>This interaction differs from Flickr which increases the velocity to make the jump
between slides.</p>

<p><img src="/images/glass-far-click.gif" alt="Glass Far Click" /></p>

<!--
cubic-bezier(0.325, 0, 0.000, 1.650);
-->


<h3>Paul Stamatiou</h3>

<p><a href="http://paulstamatiou.com/">Paul Stamatiou</a> is a designer at Twitter.
This is a pretty interesting interaction he used for his site&#8217;s navigation.</p>

<p><img src="/images/stamatiou-nav.gif" alt="Stamatiou Nav" /></p>

<p>This interaction uses a custom bezier-curve <code>cubic-bezier(0.325, 0, 0.000, 1.650)</code>
which is a combination of a very short easeIn followed by an
exaggerated easeOutBack. This gives the navigation playfulness.</p>

<p><img src="/images/crazyeaseOutBack.png" alt="crazy Ease Out Back" /></p>

<p><a href="http://matthewlein.com/ceaser/">Source: Ceaser</a></p>

<h3>Google Design Example: Radial Action</h3>

<p>This example is from Google&#8217;s Material Design section on
<a href="http://www.google.com/design/spec/animation/responsive-interaction.html#responsive-interaction-surface-response">Responsive Interaction</a>.
In this example we see that the epicenter of action occurs at left and ripples out to the right.</p>

<p><img src="/images/radialReact-nav.gif" alt="Radial React" /></p>

<h2>Tools</h2>

<p>Some <strong>tools</strong> I would recommend to further explore easing are:</p>

<ul>
<li><a href="http://easings.net/">easings.net</a>
  <img src="/images/easings.png" alt="easings.net" />

<ul>
<li>provides a visual holistic overview of easing functions as well as methods to performing the easing in JavaScript and CSS.</li>
</ul>
</li>
<li><a href="http://cubic-bezier.com/#.17,.67,.83,.67">cubic-bezier.com</a>
  <img src="/images/cubic-bezier.png" alt="cubic-bezier.com" />

<ul>
<li>CSS easing tool created by <a href="http://lea.verou.me/">Lea Verou</a> to preview and compare various easings in CSS. This tool
also lets you create your own custom easings.</li>
<li>This tool also allows one to share various easings as a url by specifying the parameters as a fragment like so
<a href="http://cubic-bezier.com/#.17,.67,.83,.67">http://cubic-bezier.com/#.17,.67,.83,.67</a></li>
</ul>
</li>
<li><a href="http://matthewlein.com/ceaser/">Ceaser</a><br/>
  <img src="/images/ceaser.png" alt="Ceaser" />

<ul>
<li>Another CSS easing tool created by <a href="http://matthewlein.com/">Matthew Lein</a>.</li>
<li>Unlike cubic-bezier(mentioned above):

<ul>
<li>Has <strong>finer granularity</strong>

<ul>
<li>Rounds to <strong>thousandths place</strong> whereas <a href="http://cubic-bezier.com/">cubic-bezier.com</a> rounds to <strong>hundredths place</strong></li>
<li>For example representing <a href="http://cubic-bezier.com/#.25,.25,.39,1.37">http://cubic-bezier.com/#0.250,0.250,0.390,1.365</a>
gets approximated as <a href="http://cubic-bezier.com/#.25,.25,.39,1.37">http://cubic-bezier.com/#.25,.25,.39,1.37</a></li>
</ul>
</li>
<li>No side-by-side comparisons</li>
<li>In addition to animating position, the tools also allows you to animate width, height, and opacity.</li>
</ul>
</li>
</ul>
</li>
</ul>


<!--
    Easing has been approximated with Cubic Bezier Curves
-->


<h2>Conclusion</h2>

<p>Motion is becoming more prevalent on the web and on mobile.
I hoped through this post you have developed an understanding of what easings are the relationship betwen different easings and
learned how to choose and apply easings. Lastly I&#8217;ve linked some videos for inspiration.</p>

<p><a href="http://vimeo.com/93206523">The illusion of life</a> from <a href="http://vimeo.com/centodesign">cento lodigiani</a> on <a href="https://vimeo.com">Vimeo</a>.</p>


<iframe src="//player.vimeo.com/video/93206523" width="500" height="198" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>


<p></p>

<p><a href="http://vimeo.com/99876106">Elements of Design</a> from <a href="http://vimeo.com/user7248612">matt greenwood</a> on <a href="https://vimeo.com">Vimeo</a>.</p>


<iframe src="//player.vimeo.com/video/99876106" width="500" height="281" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>


<p></p>

<h2>Further Reading</h2>

<ol>
<li><a href="http://en.wikipedia.org/wiki/12_basic_principles_of_animation">12 Principles of Animation</a>

<ul>
<li>Related video explaining these principles  <a href="http://vimeo.com/93206523">The illusion of life</a></li>
</ul>
</li>
<li><a href="http://www.robertpenner.com/easing/">Robert Penner Easing Resources</a>

<ul>
<li><a href="http://www.robertpenner.com/easing/penner_chapter7_tweening.pdf">Robert Penners Chapter on Tweening</a></li>
<li><a href="http://gilmoreorless.github.io/sydjs-preso-easing/">Ease Yourself Into Animation</a></li>
<li><a href="http://upshots.org/actionscript/jsas-understanding-easing">Understanding Easing: Explaining Penner&#8217;s Equations</a></li>
</ul>
</li>
<li><a href="http://www.google.com/design/spec/animation/authentic-motion.html">Google Design Guidelines</a></li>
<li><a href="https://developers.google.com/web/fundamentals/look-and-feel/animations/asymmetric-animation-timing">Google Web Fundametals on Easing</a></li>
<li><a href="http://www.smashingmagazine.com/2012/10/30/motion-and-animation-a-new-mobile-ux-design-material/">Motion and Animation, A new mobile UX Design Material</a></li>
</ol>


<script async src="//codepen.io/assets/embed/ei.js"></script>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/05/24/what-i-learned-from-launching-version-2-of-my-portfolio/">What I Learned From Launching Version 2 of My Portfolio</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-24T00:21:00-07:00" pubdate data-updated="true">May 24<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="/images/radialglo-med-grey.png" alt="radialglo version 2" /></p>

<h3>Introduction</h3>

<p>I recently relaunched my <a href="http://radialglo.com/">portfolio</a>! My site is currently runs on <a href="http://aws.amazon.com/ec2/">Amazon EC2</a>
which is a service that Amazon provides that allows users to rent virtual computers to run their own applications.
The backend of my application runs on <a href="http://expressjs.com/">express</a>, a web application framework for node.
My client side code is written using <a href="https://github.com/radialglo/guac">Guac</a>, a framework I wrote modeled after jQuery
after studying its source code. This framework is still under active development.</p>

<p>In this post I will talk about <strong>my NodeJS production environment on Amazon EC2.</strong></p>

<h3>How EC2 fits into Scalable Web Architecture</h3>

<p>Usually when building scalable web architecture, you will have multiple instances
of your application behind <a href="http://en.wikipedia.org/wiki/Load_balancing_(computing)">load balancers</a>.
Below the web server/application layer is the <a href="http://en.wikipedia.org/wiki/Persistence_(computer_science)">persistence layer</a> that runs
a database management system. Finally, since roughly  80-90% of the end-user response time is spent downloading static
components in the page (<a href="http://www.stevesouders.com/blog/2012/02/10/the-performance-golden-rule/">Performance Golden Rule.</a>),
a <a href="http://www.nczonline.net/blog/2011/11/29/how-content-delivery-networks-cdns-work/">Content Delivery Network</a> is used to distribute
static content.  A CDN manages servers in multiple geographically distributed locations,
stores copies of the videos (and other types of Web content, including documents, images, and audio) in its servers,
and attempts to direct each user request to a CDN location that will provide the best user experience.</p>

<p>Read here for more on <a href="http://philip.greenspun.com/seia/scaling">Scaling Internet Applications</a>.</p>

<p><img src="/images/aeb-architecture_crossaws3.gif" alt="Web Application Hosting Architecture" /></p>

<p>Amazon&#8217;s <a href="http://docs.aws.amazon.com/gettingstarted/latest/wah-linux/web-app-hosting-intro.html">getting started with AWS</a>
highlights a sample web application designed in the manner described above.
From their website:</p>

<blockquote><p>In this diagram, Amazon EC2 instances run the application and web server and belong to an Amazon EC2 Security Group.<br/>The Amazon EC2 Security Group acts as an exterior firewall for the Amazon EC2 instances.<br/>An Auto Scaling group is used to maintain a fleet of Amazon EC2 instances that can handle the presented load.<br/>This Auto Scaling group spans over multiple Availability Zones to protect against potential failures if an Availabilty Zone becomes unavailable.<br/>To ensure that traffic is distributed evenly among the Amazon EC2 instances, an Elastic Load Balancer is associated with the Auto Scaling group.<br/>If the Auto Scaling group launches or terminates instances based on load, then the Elastic Load Balancer will automatically adjust accordingly.<br/>The database tier consists of Amazon RDS database instances, including master and local slave, located in multiple Availability Zones for failover protection.<br/>Amazon RDS provides automated backups to Amazon S3. Amazon S3 stores backups and static content.<br/>Since the consumers of this application may be globally distributed or a large number may visit the site at one time, high volume static content is edge cached using Amazon CloudFront for better performance.<br/>Amazon Route 53 can be used to provide secure and reliable routing to your infrastructure that uses Amazon Web Services.</p></blockquote>


<p><em><a href="http://docs.aws.amazon.com/gettingstarted/latest/wah-linux/web-app-hosting-intro.html">Source</a></em></p>

<p>My personal website, <a href="http://radialglo.com">radialglo</a>, operates at a small scale and simply
use <strong>Amazon EC2</strong> to run my web and application server. Since my site recieves relatively low traffic, I currently don&#8217;t use load balancers,
and to minimize costs I currently don&#8217;t use a CDN.</p>

<h3>Create AWS account</h3>

<p>If you haven&#8217;t already create an <a href="https://aws.amazon.com/">Amazon Web Services</a> account.
Please note that there is a <a href="https://aws.amazon.com/free/faqs/">free usage tier</a> for the <strong>first 12 months</strong>
after you sign up for AWS.</p>

<h3>Setting up an Amazon EC2 instance</h3>

<p><img src="/images/EC2%20Management%20Console.png" alt="EC2 Management Console" /></p>

<p>After setting up your AWS account, you will need to choose the type of AMI you want to run.</p>

<h4>Choose an AMI</h4>

<p>An <strong>AMI</strong> (Amazon Machine Image) is a template that contains the software configuration (operating system, application server, and applications)
required to launch your instance. You can select an AMI provided by AWS, our user community, or the AWS Marketplace; or you can select one of your own AMIs.</p>

<p>Essentially you choose the type of operating system you want to run, and create an instance of that operating system.
A similar analogy would be purchasing a <strong>MacBook Air</strong> which is an instance of the <strong>Mac OS X</strong> operating system.
At the time of the writing I selected <a href="http://releases.ubuntu.com/13.10/"><strong>Ubuntu 13.10 (Saucy Salamander) Server</strong>.</a> as my AMI.</p>

<h4>Difference Between Desktop and Server Images</h4>

<p>The server image is a stripped down version of the desktop image with additional server software such as Apache 2.
Ths additional software allows other computers/machines to communicate with your server.
The server also does not contain a GUI(graphical user interface) for security and performance reasons.</p>

<p>More from the <a href="https://help.ubuntu.com/community/ServerFaq#What.27s_the_difference_between_desktop_and_server.3F">ubuntu documentation</a>.</p>

<blockquote><p>1. The first difference is in the CD contents. The &#8220;Server&#8221; CD avoids including what Ubuntu considers desktop packages (packages like X, Gnome or KDE), but does include server related packages (Apache2, Bind9 and so on). Using a Desktop CD with a minimal installation and installing, for example, apache2 from the network, one can obtain the exact same result that can be obtained by inserting the Server CD and installing apache2 from the CD-ROM.</p><p>2. The Ubuntu Server Edition installation process is slightly different from the Desktop Edition. Since by default Ubuntu Server doesn&#8217;t have a GUI, the process is menu driven, very similar to the Alternate CD installation process.</p><p>3. Before 12.04, Ubuntu server installs a server-optimized kernel by default. Since 12.04, there is no difference in kernel between Ubuntu Desktop and Ubuntu Server since linux-image-server is merged into linux-image-generic.</p><p>4. For Ubuntu LTS releases before 12.04, the Ubuntu Desktop Edition only receives 3 years of support. This was increased to 5 years in Ubuntu LTS 12.04 In contrast, all Ubuntu LTS Server Edition releases are supported for 5 years.</p></blockquote>


<h3>Choose an Instance Type</h3>

<p>After selecting your AMI, choose an <a href="http://aws.amazon.com/ec2/instance-types/">instance type</a>.</p>

<p>Instance types have  varying CPU, memory, storage, and networking capacity which gives you the flexibility to choose the appropriate mix of resources for your applications
Since I&#8217;m running low traffic website, I used the t1.micro instance which is part of the <strong>free eligibility tier</strong>.</p>

<p><img src="/images/choose%20an%20instance%20type.png" alt="Choose an Instance Type" /></p>

<p>For steps 3 and 4 in the dashboard, I used the default instance and storage configurations.
I also skipped step 5 for tagging instances, because I am currently running on instance.</p>

<h3>Security Groups</h3>

<p>A security group defines firewall rules for your instances.
These rules specify which incoming network traffic should be delivered to your instance (e.g., accept web traffic on port 80). All other traffic is ignored. You can modify rules for a group at any time. The new rules are automatically enforced for all running instances. For more information about security groups, go to Using Security Groups in the Amazon Elastic Compute Cloud (Amazon EC2).
<img src="/images/security%20groups.png" alt="Security Groups" />
<img src="/images/instance%20page.png" alt="Instance Page" /></p>

<h3>Logging into Your EC2 Instance</h3>

<p>You must use key-based authentication to login to your Amazon EC2 Instance. This allows you
to securely access your instance without a password.</p>

<p>You can also import your own key pairs to your Amazon instance. For more refer to <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html">EC2 Key Pair Documentation</a></p>

<p>On a Linux/Unix instance, the public key content is placed in an entry within <code>~/.ssh/authorized_keys</code>.
After you have created/downloaded your private key pair you can <a href="https://www.digitalocean.com/community/tutorials/how-to-use-ssh-to-connect-to-a-remote-server-in-ubuntu">ssh</a>
into your server using that private key <code>ssh -i ~/.ssh/your_private_key remote_user@remote_host</code></p>

<p>I added my EC2 instance to my user <a href="http://www.cyberciti.biz/faq/create-ssh-config-file-on-linux-unix/">ssh configuration</a> file in my local development environment located at <code>~/.ssh/config</code>.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Host awshost
</span><span class='line'>    HostName 11.111.111.111
</span><span class='line'>    User bob
</span><span class='line'>    IdentityFile /Users/bob/.ssh/id_rsa</span></code></pre></td></tr></table></div></figure>


<p>Now I can simply ssh into my EC2 instance with the command <code>ssh awshost</code>.</p>

<p>You can also add a bash alias <code>~/.bash_aliases</code> for issuing this command. For example:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>alias ssh_server="ssh awshost"</span></code></pre></td></tr></table></div></figure>


<h3>Port Forwarding</h3>

<p>Before proceeding make sure you that the security group for your instance has been configured to accept HTTP traffic on port 80.</p>

<h4>Why port forward</h4>

<p>Running with superuser privileges (in order to bind the port) may be a security risk to the host, therefore port forwarding is used to redirect a low-numbered port to another high-numbered port, so that application software may execute as a common operating system user with reduced privileges.
Standard practices say no non-root process gets to talk to the Internet on a port less than 1024.</p>

<h4>Use case for port forwarding</h4>

<p>Express (the web application framework for node) is capable of performing everything that is expected of a modern web server, such as logging requests, HTTPS, serving files and so on.</p>

<p>If you are running a small application it may make sense to have your node application double up as a web and application server.
This is where port forwarding comes in.
Because I ran my application as both web and application server, giving root access is not ideal because my application server should not need root permissions.</p>

<p>However, if you are building a large scalable, application you should put a reverse proxy in front of the application server.
More regarding reverse proxies will be discussed below.</p>

<h4>Enable port forwarding</h4>

<p>The <code>/etc/sysctl.conf</code> file allows you to configure various Linux networking and system settings.</p>

<p>No settings where enabled for my EC2 Instance by default. Running <code>cat /proc/sys/net/ipv4/ip_forward</code> will print 1 if forwarding is enabled.</p>

<p>Now we want to edit <code>/etc/syctl.conf</code> to enabled port forwarding.</p>

<p><code>sudo vim /etc/sysctl.conf</code></p>

<p>In this file, uncomment this line:</p>

<p><code>net.ipv4.ip_forward</code></p>

<p>This will enable ip forwarding. Then, to enable the changes made in sysctl.conf:</p>

<p><code>sudo sysctl -p /etc/sysctl.conf</code> loads the values from the file we just edited.
Now, let&#8217;s check that ip forwarding is enabled:</p>

<p><code>cat /proc/sys/net/ipv4/ip_forward</code>
This should print <code>1</code>.</p>

<h4>How to port forward</h4>

<p><a href="http://kentbrewster.com/">Kent Brewster</a> at <a href="http://www.pinterest.com/">Pinterest</a>
wrote a useful <a href="https://gist.github.com/kentbrew/776580">gist</a> for getting node to talk to port 80.
Here are the steps I went through.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// First list out configuration for IP table
</span><span class='line'>sudo iptables -t nat -L -n -v
</span><span class='line'>
</span><span class='line'>// -t nat =&gt; we are modifying the nat(Network Address Translation) table
</span><span class='line'>// -n =&gt; use numeric output
</span><span class='line'>// -v =&gt; use verbose to output exact rules
</span><span class='line'>
</span><span class='line'>// Output showing no routing options
</span><span class='line'>Chain PREROUTING (policy ACCEPT 21 packets, 1296 bytes)
</span><span class='line'>pkts bytes target     prot opt in     out     source               destination
</span><span class='line'>
</span><span class='line'>Chain INPUT (policy ACCEPT 21 packets, 1296 bytes)
</span><span class='line'>pkts bytes target     prot opt in     out     source               destination
</span><span class='line'>
</span><span class='line'>Chain OUTPUT (policy ACCEPT 43 packets, 3815 bytes)
</span><span class='line'>pkts bytes target     prot opt in     out     source               destination
</span><span class='line'>
</span><span class='line'>Chain POSTROUTING (policy ACCEPT 43 packets, 3815 bytes)
</span><span class='line'>pkts bytes target     prot opt in     out     source               destination
</span><span class='line'>
</span><span class='line'>// Redirect TCP port 80 to port 3000
</span><span class='line'>
</span><span class='line'>sudo iptables -t nat -A PREROUTING -p tcp --dport 80 -j  REDIRECT --to-ports 3000
</span><span class='line'>
</span><span class='line'>// Output table again to verify that configuration worked
</span><span class='line'>sudo iptables -t nat -L -n -v
</span><span class='line'>
</span><span class='line'>Chain PREROUTING (policy ACCEPT 0 packets, 0 bytes)
</span><span class='line'>pkts bytes target     prot opt in     out     source               destination
</span><span class='line'>6   384 REDIRECT   tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:80 redir ports 3000
</span><span class='line'>
</span><span class='line'>Chain INPUT (policy ACCEPT 6 packets, 384 bytes)
</span><span class='line'>pkts bytes target     prot opt in     out     source               destination
</span><span class='line'>
</span><span class='line'>Chain OUTPUT (policy ACCEPT 2 packets, 178 bytes)
</span><span class='line'>pkts bytes target     prot opt in     out     source               destination
</span><span class='line'>
</span><span class='line'>Chain POSTROUTING (policy ACCEPT 2 packets, 178 bytes)
</span><span class='line'>pkts bytes target     prot opt in     out     source               destination
</span></code></pre></td></tr></table></div></figure>


<h3>Reverse Proxy - an alternative to port forwarding</h3>

<p>A <strong>reverse proxy</strong> manages inbound request from  the internet  and manages connections within your servers, where as forward proxies
filters outbound connections from clients.</p>

<p>More specifically from the <a href="http://httpd.apache.org/docs/2.2/mod/mod_proxy.html">Apache mod_proxy documentation</a>:</p>

<blockquote><p>An ordinary forward proxy is an intermediate server that sits between the client and the origin server. In order to get content from the origin server, the client sends a request to the proxy naming the origin server as the target and the proxy then requests the content from the origin server and returns it to the client. The client must be specially configured to use the forward proxy to access other sites.</p><p>A typical usage of a forward proxy is to provide Internet access to internal clients that are otherwise restricted by a firewall. </p><p>As standard practice in the industry, you should put reverse proxies in front of the application server to load balance and scale the app.</p><p>A reverse proxy (or gateway), by contrast, appears to the client just like an ordinary web server. No special configuration on the client is necessary. The client makes ordinary requests for content in the name-space of the reverse proxy. The reverse proxy then decides where to send those requests, and returns the content as if it was itself the origin.</p></blockquote>


<p>According to this <a href="http://blogs.citrix.com/2010/10/04/reverse-vs-forward-proxy/">article</a> written by Citrix,  reverse proxies are also particularly
good for application delivery including:</p>

<ul>
<li>Load Balancing (TCP Multiplexing)</li>
<li>SSL Offload/Acceleration (SSL Multiplexing)</li>
<li>Caching</li>
<li>Compression</li>
<li>Content Switching/Redirection</li>
<li>Application Firewall</li>
<li>Server Obfuscation</li>
<li>Authentication</li>
<li>Single Sign On</li>
</ul>


<p><img src="/images/Citrix_ReverseProxy_101003.jpg" alt="reverse proxy" /></p>

<p><a href="http://blogs.citrix.com/2010/10/04/reverse-vs-forward-proxy/">Source</a></p>

<p>I currently have not set up a reverse proxy, but am looking into setting one up in the next iteration.</p>

<h3>Setting Up Git for Deployment</h3>

<p>If you need a refresher on <a href="http://en.wikipedia.org/wiki/Git_(software)">Git</a> I would recommend talking a look at <a href="https://www.atlassian.com/git/tutorial/git-basics">Atlassian&#8217;s Git Tutorials</a>
and the <a href="http://git-scm.com/book">Git book</a>.</p>

<p>My code deployment is adapted from <a href="http://git-scm.com/book/en/Git-on-the-Server-Getting-Git-on-a-Server">Getting Git on a Server</a>
from the the <a href="http://git-scm.com/book">Git book</a> and <a href="http://toroid.org//ams/git-website-howto">http://toroid.org//ams/git-website-howto</a>.</p>

<p>The gists of my setup is to create a create a <strong>bare</strong> repository for shared users to check in their code and a separate working <strong>directory</strong>( a single checkout of one version of the project )
that is populated with code from the bare repository via a <strong>post-recieve</strong> hook.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// On the server, create a new repository to mimic the local one
</span><span class='line'>git init --bare radialglo.git
</span><span class='line'>
</span><span class='line'>// initialize a detached workign directory
</span><span class='line'>mkdir app
</span><span class='line'>
</span><span class='line'>// Create a post-recieve hook, that updates the code in the app, and restarts the app server
</span><span class='line'>// vim radialglo.git/hooks/post-recieve
</span><span class='line'>
</span><span class='line'>#!/bin/bash
</span><span class='line'>APP_DIR="app"
</span><span class='line'>// note that our working tree is not in the same directory as our bare repostiory
</span><span class='line'>git --work-tree=$APP_DIR checkout -f
</span><span class='line'>cd $APP_DIR
</span><span class='line'>forever stopall
</span><span class='line'>// install production dependencies and restart server
</span><span class='line'>npm i --production && forever start app.js</span></code></pre></td></tr></table></div></figure>


<h3>Setting up NodeJS</h3>

<p>For more information regarding installing node via package manager refer to documentation <a href="https://github.com/joyent/node/wiki/Installing-Node.js-via-package-manager">here</a>.</p>

<p>I installed node on Ubuntu 13.10.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo apt-get install nodejs
</span><span class='line'>
</span><span class='line'>// verify nodejs works
</span><span class='line'>nodejs -v // =&gt; v0.10.15
</span><span class='line'>
</span><span class='line'>// symlink node to nodejs, /usr/bin/node to /usr/bin/nodejs
</span><span class='line'>sudo ln -s /usr/bin/nodejs /usr/bin/node
</span><span class='line'>
</span><span class='line'>// verify symlink works
</span><span class='line'>node -v // =&gt; v0.10.15
</span><span class='line'>
</span><span class='line'>// install node package manager
</span><span class='line'>sudo apt-get install npm
</span><span class='line'>// verify npm works
</span><span class='line'>npm -v // 1.4.7</span></code></pre></td></tr></table></div></figure>


<p><a href="https://www.linkedin.com/">Linkedin</a> wrote a great article for <a href="http://engineering.linkedin.com/nodejs/blazing-fast-nodejs-10-performance-tips-linkedin-mobile">performance tips for NodeJS</a>.</p>

<h4>Setting up Express</h4>

<p>First let&#8217;s install <code>express</code>.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>npm i --save express</span></code></pre></td></tr></table></div></figure>


<p><code>--save</code> saves meta data regarding your  dependencies (name and version number) into a dependency management file called <code>package.json</code>. Using the flag <code>--save-dev</code> saves the dependencies
as development  dependencies. The <em>package.json</em> file is really convenient because you don&#8217;t need to save your</p>

<p>A middleware is a JavaScript function to handle HTTP requests to an Express app. It can manipulate the request and the response objects or perform an isolated action, or terminate the request flow by sending a response to the client, or pass on the control to the next middleware
(from <a href="http://www.amazon.com/Express-Application-Development-Hage-Yaapa-ebook/dp/B00DMYO1TM">Express Web Application Development</a> ).</p>

<p>I am currently using <a href="https://github.com/visionmedia/express/wiki/New-features-in-4.x">Express 4</a> which is quite bare bones
in comparison to Express 3 because it no longer comes with bundled middleware.</p>

<p>My package.json for development looks like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>{
</span><span class='line'>  "name": "Radialglo",
</span><span class='line'>  "version": "0.1.0",
</span><span class='line'>  "author": "asu",
</span><span class='line'>  "private": true,
</span><span class='line'>  "devDependencies": {
</span><span class='line'>    "grunt": "~0.4.1",
</span><span class='line'>    "grunt-contrib-watch": "*",
</span><span class='line'>    "grunt-contrib-jshint": "~0.6.3",
</span><span class='line'>    "grunt-contrib-uglify": "*",
</span><span class='line'>    "grunt-contrib-cssmin": "*",
</span><span class='line'>    "grunt-contrib-sass": "*",
</span><span class='line'>    "grunt-cssc": "*",
</span><span class='line'>    "grunt-htmlhint": "*",
</span><span class='line'>    "load-grunt-tasks": "~0.2.0",
</span><span class='line'>    "grunt-contrib-concat": "~0.4.0",
</span><span class='line'>    "grunt-shell": "~0.6.4"
</span><span class='line'>  },
</span><span class='line'>  "dependencies": {
</span><span class='line'>    "normalize.css": "~3.0.1",
</span><span class='line'>    "express": "~4.0.0",
</span><span class='line'>    "compression": "~1.0.1",
</span><span class='line'>    "forever": "~0.11.0",
</span><span class='line'>    "marked": "~0.3.2",
</span><span class='line'>    "path": "~0.4.9",
</span><span class='line'>    "jade": "~1.3.1",
</span><span class='line'>    "body-parser": "~1.0.2"
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Some useful packages include <code>compression</code> and <code>body-parser</code>.</p>

<p>As previously mentioned, Node can also serve as a web server.
For example, Node serves static content. <code>compress</code> is used to <em>gzip</em> static content before it is
returned to the user:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>var express = require('express'),
</span><span class='line'>    app = express(),
</span><span class='line'>    compress = require('compression')(),
</span><span class='line'>    ...;
</span><span class='line'>
</span><span class='line'>// set the maxAge for one day specified in seconds for cache-control
</span><span class='line'>// From rfc 2616
</span><span class='line'>// When the max-age cache-control directive is present in a cached response, 
</span><span class='line'>// the response is stale if its current age is greater than the age value given (in seconds) 
</span><span class='line'>// at the time of a new request for that resource. The max-age directive on a response implies that
</span><span class='line'>// the response is cacheable (i.e., "public") unless some other, more restrictive cache directive is also present.
</span><span class='line'>// http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html
</span><span class='line'>
</span><span class='line'>app.use(compress);
</span><span class='line'>
</span><span class='line'>// expose the static directory
</span><span class='line'>app.use(express.static(__dirname + '/public', { maxAge: 86400 }));</span></code></pre></td></tr></table></div></figure>


<h5>Templating</h5>

<p>To decouple the output representation, I used <a href="http://jade-lang.com/">Jade</a>, a templating language to handle the view.</p>

<p><code>npm --save express</code> to install express.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// set templating engine for express
</span><span class='line'>app.set('view engine', 'jade');
</span><span class='line'>
</span><span class='line'>// set view directory
</span><span class='line'>app.set('views', './views');</span></code></pre></td></tr></table></div></figure>


<h5>AWS SDK for JavaScript</h5>

<p>Amazon also provides an <a href="http://aws.amazon.com/sdkfornodejs/">AWS Software Development Kit for NodeJS</a>.
This provides opportunities to build more complex applications.</p>

<p>I learned a lot from developing version 2 of <a href="http://radialglo.com">radiaglo.com</a>, and for next iteration
look to experimenting more with other services provided by AWS such as S3 as well as configuring servers (nginx in particular).</p>

<!--
[Managing Multiple Users](http://utkarshsengar.com/2011/01/manage-multiple-accounts-on-1-amazon-ec2-instance/)
-->



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/12/29/attribute-nodes-of-html-elements/">Attribute Nodes of HTML Elements</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-12-29T04:35:00-08:00" pubdate data-updated="true">Dec 29<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Context</h3>

<p>The following question was asked recently on <a href="http://piazza.com" target="_blank">Piazza</a></p>

<blockquote><p>Do JavaScript event attributes (in addition to other HTML attributes, like &#8220;id&#8221;, &#8220;style&#8221;, etc), onclick for example, create non-child attribute nodes of the associated html element?</p></blockquote>


<p>For example:</p>

<figure class='code'><figcaption><span>Diagram of Question </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;body id="test" onclick="doSomething();">
</span><span class='line'>    This is &lt;b>a&lt;/b> test.
</span><span class='line'>&lt;/body>
</span><span class='line'> 
</span><span class='line'>Would this create 7 nodes?
</span><span class='line'>              (onclick)  &lt;--  (body) --> (id)
</span><span class='line'>                             /   |   \
</span><span class='line'>                   ("this is")  (b)  ("test")
</span><span class='line'>                                 |
</span><span class='line'>                               ("a")</span></code></pre></td></tr></table></div></figure>


<h3>Response</h3>

<h4>Short answer:</h4>

<p><strong>Yes</strong></p>

<h4>Long Answer:</h4>

<p><strong> Yes, but be aware&#8230; </strong>
There are <strong>different ways to add event handlers to an element</strong>,
and not all methods introduce an attribute node.
The two ways of <strong>adding event handlers by creating an attribute node</strong> are</p>

<ol>
<li><strong>directly in HTML</strong>  (what you did)</li>
<li>using JavaScript such as the method <strong>setAttribute</strong> .</li>
</ol>


<p>However there are still different ways to add event handlers that don&#8217;t introduce attribute nodes.</p>

<p>As as side note, there are 5 versions of the the DOM specification (DOM Level 0 -3)
and the current version DOM4 also known as the DOM Living Standard (http://dom.spec.whatwg.org/)
An interesting to note is that the <strong>DOM Level 2</strong> introduced the <strong>Events specification</strong> <a href="http://www.w3.org/TR/DOM-Level-2-Events/events.html">http://www.w3.org/TR/DOM-Level-2-Events/events.html</a></p>

<p><em>In particular under the section 1.3.2. Interaction with HTML 4.0 event listeners,</em></p>

<blockquote><p>&#8220;In HTML 4.0, <b>event listeners were specified as attributes of an element. As such, registration of a second event listener of the same type would replace the first listener.</b>The <b>DOM Event Model allows registration of multiple event listeners</b> on a single EventTarget. To achieve this, event listeners are no longer stored as attribute values. </p><p>In order to achieve compatibility with HTML 4.0, implementors may view the setting of attributes which represent event handlers as the creation and registration of an EventListener on the EventTarget. The value of useCapture defaults to false. This EventListener behaves in the same manner as any other EventListeners which may be registered on the EventTarget. If the attribute representing the event listener is changed, this may be viewed as the removal of the previously registered EventListener and the registration of a new one. No technique is provided to allow HTML 4.0 event listeners access to the context information defined for each event.<br/>&#8221;</p></blockquote>


<p>We didn&#8217;t really talk about (in class) adding event listeners and the difference between doing it in HTML versus JavaScript,
but it&#8217;s <strong>generally bad practice</strong> to introduce event handlers in the HTML, because we want to <strong>separate the concerns</strong> of our structure(HTML) and our behavior(JavaScript).
Otherwise there is too much coupling .(This is also why CSS stylesheets are often used instead of inline CSS). There are also other reasons.
This concept is known as <strong>unobtrusive JavaScript</strong>, and you can read more about this here:<a href="http://www.w3.org/wiki/The_principles_of_unobtrusive_JavaScript">http://www.w3.org/wiki/The_principles_of_unobtrusive_JavaScript</a>.
Finally let&#8217;s illustrate this through some HTML and JavaScript! Copy paste the code below into an .html file, and then open it in a browser. Click on the body and view console to see what exactly happens.</p>

<figure class='code'><figcaption><span>DOM versus DOM Tree  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;html&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;head&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// dom levels https://developer.mozilla.org/en-US/docs/DOM_Levels</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// DOM Living Standard: http://dom.spec.whatwg.org/</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// http://www.w3.org/wiki/The_principles_of_unobtrusive_JavaScript</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">list</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">function</span> <span class="nx">log</span><span class="p">(</span><span class="nx">txt</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">list</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">li</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;li&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">li</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createTextNode</span><span class="p">(</span><span class="nx">txt</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">list</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">li</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">doc</span> <span class="o">=</span> <span class="nb">document</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">body</span> <span class="o">=</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// get the list node, when the page loads</span>
</span><span class='line'>      <span class="nx">list</span> <span class="o">=</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;list&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">body</span><span class="p">.</span><span class="nx">click</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">.</span><span class="nx">attributes</span><span class="p">[</span><span class="s2">&quot;onclick&quot;</span><span class="p">]);</span> <span class="c1">// it exists </span>
</span><span class='line'>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;onclick&quot;</span><span class="p">));</span> <span class="c1">// it exists </span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// remove inline onclick attribute node</span>
</span><span class='line'>      <span class="nx">body</span><span class="p">.</span><span class="nx">removeAttribute</span><span class="p">(</span><span class="s2">&quot;onclick&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>      <span class="cm">/*</span>
</span><span class='line'>
</span><span class='line'><span class="cm">        .attributes is a collection of all attribute nodes registered to the specified node.</span>
</span><span class='line'>
</span><span class='line'><span class="cm">        getAttribute is used to get the corresponding attribute node</span>
</span><span class='line'>
</span><span class='line'><span class="cm">      */</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// sets onclick attribute but doesn&#39;t introduce an attribute node</span>
</span><span class='line'>      <span class="nx">body</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">log</span><span class="p">(</span><span class="s2">&quot;I am not an attribute node. Event added via .onclick&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="nx">body</span><span class="p">.</span><span class="nx">click</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;onclick&quot;</span><span class="p">));</span> <span class="c1">// null</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// now we can add another event via DOM Level 2 Specification</span>
</span><span class='line'>      <span class="c1">// http://www.quirksmode.org/js/events_advanced.html</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">body</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">log</span><span class="p">(</span><span class="s2">&quot;I am not an attribute node. Event added via addEventListener.&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>      <span class="nx">body</span><span class="p">.</span><span class="nx">click</span><span class="p">();</span>
</span><span class='line'>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;onclick&quot;</span><span class="p">));</span> <span class="c1">// null</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;/script&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;/head&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;body</span> <span class="na">onclick=</span><span class="s">&quot;log(&#39;I am an attribute node&#39;);&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;ol</span> <span class="na">id=</span><span class="s">&quot;list&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;/ol&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/12/18/dom-versus-dom-tree/">DOM Versus DOM Tree</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-12-18T20:23:00-08:00" pubdate data-updated="true">Dec 18<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Context</h3>

<p>A fellow classmate asked the following question recently on <a href="http://piazza.com" target="_blank">Piazza</a></p>

<blockquote><p>Is the value of a attribute in a element become a node in HTML DOM?<br/>e.g. &lt;a href=&quot;good&quot;&gt;&lt;/a&gt; is &#8220;good&#8221; a text node or something else?</p></blockquote>


<p>Unfortunately, I was stumped on the question and decided it was time to finally begin reading the DOM specifications also known as <a href="http://www.w3.org/DOM/DOMTR"><strong>DOM TR(Technical Reports)</strong></a> to get a deeper technical understanding of the DOM.</p>

<p>The current specification is <strong>DOM4</strong>. The most up to date version of this spec is available as the  <a href="http://dom.spec.whatwg.org/"><strong>DOM Living Standard</strong></a></p>

<p>One of the things I noticed is that many developers use the term DOM in place of where <strong>DOM Structure Model</strong> or <strong>DOM tree</strong>  should actually be used.
This distinction between these two terms is  crucial in answering the question.</p>

<h3>Response</h3>

<p>It&#8217;s important to distinguish between
the <strong>DOM</strong> and the <strong>DOM tree</strong>.</p>

<p><strong>The DOM is a programming API for documents.</strong></p>

<p>According to the spec,
<em>The Document Object Model (DOM) is an application programming interface (API) for valid HTML and well-formed XML documents.</em><a href="http://www.w3.org/TR/2004/REC-DOM-Level-3-Core-20040407/introduction.html">http://www.w3.org/TR/2004/REC-DOM-Level-3-Core-20040407/introduction.html</a></p>

<p><strong>The DOM tree refers to the structure model of the document(not the DOM).</strong></p>

<p>According to the spec,
<em>In this specification, we use the term structure model to describe the tree-like representation of a document.
We also use the term &#8220;tree&#8221; when referring to the arrangement of those information items which can be reached
by using &#8220;tree-walking&#8221; methods; (this does not include attributes).</em>
<a href="http://www.w3.org/TR/2004/REC-DOM-Level-3-Core-20040407/introduction.html">http://www.w3.org/TR/2004/REC-DOM-Level-3-Core-20040407/introduction.html</a></p>

<p><strong>In other words, attribute is considered a node in the DOM(API for documents),
but not a node in the DOM tree(structure of documents).</strong></p>

<p>More specifically from the spec,<em>
Attr objects inherit the Node interface, but since they are not actually child nodes of the element they describe, the DOM does not consider them part of the document tree. Thus, the Node attributes parentNode, previousSibling, and nextSibling have a null value for Attr objects.</em>
<a href="http://www.w3.org/TR/2004/REC-DOM-Level-3-Core-20040407/core.html#ID-637646024">http://www.w3.org/TR/2004/REC-DOM-Level-3-Core-20040407/core.html#ID-637646024</a></p>

<p>I did a search for HTML DOM, and none of the technical specifications refer to the any specification as HTML DOM, except
for W3Schools.Be cautious with the wording of W3Schools <a href="http://www.w3schools.com/js/js_htmldom.asp">http://www.w3schools.com/js/js_htmldom.asp</a>.
W3Schools is not affiliated with W3C and can occasionally be incorrect with some of these nuances.
There is a site created by some of the industries leading front end engineers discussing this:
<a href="http://www.w3fools.com/">http://www.w3fools.com/</a></p>

<p><strong>To answer the question is a text node created for an attribute?, the answer is yes.</strong>
From the spec,
<em>On setting(the node value), this creates a Text node with the unparsed contents of the string.
I.e. any characters that an XML processor would recognize as markup are instead
treated as literal text. See also the method setAttribute on the Element interface.</em>
<a href="http://www.w3.org/TR/2004/REC-DOM-Level-3-Core-20040407/core.html#ID-637646024">http://www.w3.org/TR/2004/REC-DOM-Level-3-Core-20040407/core.html#ID-637646024</a></p>

<p>Finally some JavaScript to illustrate this!</p>

<figure class='code'><figcaption><span>DOM versus DOM Tree  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span><span class='line'><span class="nt">&lt;html&gt;</span>
</span><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;top_bar&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;top_bar_left clearFix&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;top_bar_logo&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</span><span class='line'>     <span class="nt">&lt;/div&gt;</span>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// https://developer.mozilla.org/en-US/docs/Web/API/Node.nodeType</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">NODE_TYPE</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">ELEMENT</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">ATTR</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">TEXT</span><span class="o">:</span> <span class="mi">3</span>
</span><span class='line'>    <span class="c1">// ...</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="p">(</span><span class="s2">&quot;INSPECTING DOM TREE ...&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="c1">// top navigation bar in piazza</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">top_bar</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;top_bar&quot;</span><span class="p">),</span>
</span><span class='line'>      <span class="c1">// get it&#39;s children</span>
</span><span class='line'>      <span class="c1">// convert array-like NodeList to Array</span>
</span><span class='line'>      <span class="nx">children</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">top_bar</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">),</span>
</span><span class='line'>      <span class="nx">attr_children_count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// iterate all the children of top_bar</span>
</span><span class='line'>    <span class="nx">children</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">child</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">child</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">===</span> <span class="nx">NODE_TYPE</span><span class="p">.</span><span class="nx">ATTR</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">attr_children_count</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">child</span><span class="p">);</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// no attribute nodes in DOM tree</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">attr_children_count</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Attributes are not considered children in the DOM tree&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="p">(</span><span class="s2">&quot;INSPECTING ATTR NODE ...&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="c1">// now let&#39;s inspect the attribute node id</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">id_node</span> <span class="o">=</span> <span class="nx">top_bar</span><span class="p">.</span><span class="nx">getAttributeNode</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">),</span>
</span><span class='line'>      <span class="c1">// get it&#39;s children</span>
</span><span class='line'>      <span class="c1">// convert array-like NodeList to Array</span>
</span><span class='line'>      <span class="nx">id_node_children</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">id_node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">id_node_children</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">child</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="c1">// confirm that id node has child text node</span>
</span><span class='line'>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">child</span><span class="p">.</span><span class="nx">nodeValue</span><span class="p">);</span> <span class="c1">// &quot;top_bar&quot;</span>
</span><span class='line'>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">child</span><span class="p">.</span><span class="nx">nodeType</span><span class="p">);</span> <span class="c1">// 3 =&gt; indicates text node</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;/script&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span><span class='line'><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Note on DOM4</h3>

<p>In DOM4, an Attribute object, no longer extends a node object so it is not considered a node in the DOM(API for documents) for the DOM4 Spec.
You may also notice that the nodeType ATTRIBUTE_NODE is considered deprecated.
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Node.nodeType">https://developer.mozilla.org/en-US/docs/Web/API/Node.nodeType</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/04/06/ruby-jumpstart/">Ruby Jumpstart</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-06T00:16:00-07:00" pubdate data-updated="true">Apr 6<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p> This posts is an introduction to Ruby and aggregates information I have learned from <a href="http://www.codecademy.com/">Codeacademy</a> and
 <a href="http://www.amazon.com/Programming-World-Wide-Web-7th/dp/01326658160">Programming the World Wide Web</a> and <a href="http://www.amazon.com/Agile-Web-Development-Rails-Programmers/dp/097669400X">Agile Developement with Rails</a></p>

<p> Please visit <a href="http://www.ruby-lang.org/en/documentation/">here</a> for a full list of documentation and sources on the <a href="http://www.ruby-lang.org/en/">ruby language</a>.
 Another interesting resource is the <a href="http://www.rubyist.net/~slagell/ruby/index.html">Ruby&#8217;s User Guide</a>, originally written by Yukhiro Matsumoto.</p>

<hr />

<h2>Table of Contents</h2>

<p>1 - <a href="#origin">Origins and Uses of Ruby</a><br/>
2 - <a href="#naming">Naming Conventions</a><br/>
3 - <a href="#scalars">Scalars</a><br/>
4 - <a href="#io">Input and Output</a><br/>
5 - <a href="#control_statements">Control Statements</a><br/>
6 - <a href="#blocks">Code Blocks and Iterators</a><br/>
7 - <a href="#procs_and_lambdas">Procs and Lambdas</a>
8 - <a href="#control_statements">Control Statements</a><br/>
9 - <a href="#arrays">Fundamentals of Arrays</a><br/>
10 - <a href="#hash">Hashes</a><br/>
11 - <a href="#methods">Methods</a><br/>
12 - <a href="#sorting">Sorting</a>  <br/>
13 - <a href="#pattern">Pattern Matching</a> <br/>
14 - <a href="#classes">Classes</a><br/>
15 - <a href="#modules">Modules</a></p>

<h3><a id="origin"></a> Origins and Uses of Ruby</h3>

<p>  Ruby was created in Japan by <a href="http://www.rubyist.net/~matz/">Yuki &#8220;matz&#8221; Matsumoto</a> and was publicly released in 1995. Ruby blended parts of his favorite languages (Perl, Smalltalk, Eiffel, Ada, and Lisp) to form a new language that balanced functional programming with imperative programming.[1] Ruby has achieved mass acceptance especially with the quick growth of Rails, the web application framework created by <a href="http://37signals.com/">37signals</a></p>

<p>  One interesting aspect about Ruby is that <strong>everything in Ruby is an object</strong> meaning that there are instance variables with methods. Recall that in other languages such as C, primitive data types (like integers and characters) are not objects.</p>

<p>  1.<a href="http://www.ruby-lang.org/en/about/">http://www.ruby-lang.org/en/about/</a></p>

<blockquote><p>Everything in Ruby is an object.</p></blockquote>


<h3><a id="naming"></a> Naming Conventions</h3>

<p>Local variables, method parameters, and method names should all start with a lower case letter or underscore: box, water_bottle, g6.
Instance variables should begin with an &#8220;at&#8221;@ sign, such as @id, @telephone_number
The convention is to use underscores to separate words in a multiword method or variable name water_bottle as opposed to waterBottle.</p>

<p>Class names, module names, and constants muststart with an uppercase letter. By convention they use capitalization, rather than underscores, to distinguish the start of words within the name. Class names look like Object, PurcharseOrder, and LineItem. This naming convention is also known as <strong>upper camel case</strong>, since the shape of the lettering looks like the humps of camel.</p>

<p>Rails uses <em>symbols</em> to identify things. In particular, symbols are used when naming method parameters and lookingthings up in <a href="#hash">hashes</a>
Symbols are prefixed with colons : like :action or :id</p>

<figure class='code'><figcaption><span>Naming Examples  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#local variables method parameters</span>
</span><span class='line'><span class="n">watch</span>
</span><span class='line'><span class="n">ti89</span>
</span><span class='line'><span class="n">xbox360</span>
</span><span class='line'><span class="vi">@zip</span><span class="p">\</span><span class="n">_code</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#Class Names, module names, constants</span>
</span><span class='line'><span class="no">Shape</span>
</span><span class='line'><span class="no">MusicInstrument</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#symbols</span>
</span><span class='line'><span class="ss">:id</span>
</span><span class='line'><span class="c1">#symbol Example</span>
</span><span class='line'><span class="n">redirect</span><span class="p">\</span><span class="n">_to</span> <span class="ss">:action</span> <span class="o">=&gt;</span> <span class="s2">&quot;edit&quot;</span><span class="p">,</span> <span class="ss">:id</span> <span class="o">=&gt;</span> <span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Replace \_ with underscore. Need \ to escape underscore in markdown.</span>
</span></code></pre></td></tr></table></div></figure>




<blockquote><p>By convention class names, modules names and constants use capitalization to distinguish the start of words within the name. This is known as upper camelcase<br/>because of its shape.</p></blockquote>


<h3><a id="scalars"></a> Scalars</h3>

<p>Ruby has three categories of datatypes - <strong>scalars,arrays and hashes</strong>. There are two categories of scalar types numerics and character strings. Recall that everything in Ruby is an object.</p>

<h4>Numeric Literals</h4>

<p>  All numeric data types in Ruby are descendants of the <a href="http://ruby-doc.org/core-2.0/Numeric.html">Numeric</a> class. The immediate child classes of Numeric are <a href="http://www.ruby-doc.org/core-2.0/Float.html">Float</a> and <a href="http://ruby-doc.org/core-2.0/Integer.html">Integer</a>. The Integer class has two child classes <a href="http://www.ruby-doc.org/core-2.0/Fixnum.html">Fixnum</a> and <a href="http://ruby-doc.org/core-2.0/Bignum.html">Bignum</a>.<br/>
  An integer literal that fits into the range of a machine word, which is often 32 bits, is a Fixnum object (minus 1 bit). If the integer exceeds the size of the the Fixnum object then it is coereced into a Bignum object. There is no length limitation(other than the computer&#8217;s memory size) on integer literals.</p>

<p>  Underscore characters can appear embedded in integer literals, which helps readability.</p>

<figure class='code'><figcaption><span>Underscores in numeric literals </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="mi">1</span><span class="p">\</span><span class="n">_000</span> <span class="o">*</span> <span class="mi">3</span>
</span><span class='line'>   <span class="c1">#=&gt; 3000 </span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Replace \_ with underscore. Need \ to escape underscore in markdown.</span>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<p>  A numeric literal that has either an <strong>embedded decimal point</strong> or a <strong>following exponent</strong> is a <a href="http://www.ruby-doc.org/core-2.0/Float.html">Float</a> object and uses the machines double precision floating point architecture. A decimal point must be both preceded and followed by at least one digit so .35 is not valid.You must use 0.35.
   <blockquote><p>A decimal point must be both preceded and followed by at least one digit.</p></blockquote></p>

<h4>String Literals</h4>

<p>  All string literals are <a href="http://ruby-doc.org/core-2.0/String.html">String</a>. There are two categories of string literals, single quoted and double quoted. Single quoted literals cannot include characters(other than single quote characters) specified with escape characters. You can specify a single quote delimiter by preceding the delimiter with a <strong>%q</strong>. If the new delimiter is a parantheses, brace, bracket, or a point bracket, the corresponding closing element must be used.</p>

<figure class='code'><figcaption><span>Single quoted strings  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="s1">&#39;It\&#39;s good&#39;</span>
</span><span class='line'>  <span class="c1">#=&gt; It\&#39;s good</span>
</span><span class='line'>
</span><span class='line'>  <span class="s1">&#39;Roses are red, \n violets are blue&#39;</span>
</span><span class='line'>  <span class="c1">#=&gt; Roses are red, \n violets are blue</span>
</span><span class='line'>
</span><span class='line'>  <span class="sx">%q$I don&#39;t know$</span>
</span><span class='line'>  <span class="c1">#=&gt; &#39;I don&#39;t know&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="sx">%q{You don&#39;t know?}</span>
</span><span class='line'>  <span class="c1">#=&gt; &#39;You don&#39;t know?&#39;</span>
</span><span class='line'>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<p>  Double quoted strings differ from single quoted strings in two ways:
  1. They can include special characters in escape sequences
  2. The values of variables names can be interpolated into a string. With <strong>string interpolation</strong> a block of code between  #{ } is evaluated and then converted into a string.</p>

<p>  <blockquote><p>With string interpolation a block of code between  #{ } is evaluated and then converted into a string.</p></blockquote></p>

<p>  Finally a different delimiter can be used by preceding the delimiter with a <strong>%Q</strong>.</p>

<figure class='code'><figcaption><span>Double quoted strings  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'> <span class="s2">&quot;That&#39;s cool&quot;</span>
</span><span class='line'> <span class="c1">#=&gt; That&#39;s cool</span>
</span><span class='line'>
</span><span class='line'> <span class="sx">%Q@That&#39;s cool@</span>
</span><span class='line'> <span class="c1">#=&gt; That&#39;s cool</span>
</span><span class='line'>
</span><span class='line'> <span class="s2">&quot;That&#39;s </span><span class="se">\t</span><span class="s2"> cool&quot;</span> <span class="c1">#escape sequence for tab</span>
</span><span class='line'> <span class="c1">#=&gt; That&#39;s     cool</span>
</span><span class='line'>
</span><span class='line'> <span class="nb">puts</span> <span class="s2">&quot;3 + 3 = </span><span class="si">#{</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'> <span class="c1">#=&gt; 3 + 3 = 6</span>
</span><span class='line'>
</span><span class='line'> <span class="n">six</span> <span class="o">=</span> <span class="mi">6</span>
</span><span class='line'> <span class="nb">puts</span> <span class="s2">&quot;3 + 3 = </span><span class="si">#{</span><span class="n">six</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'> <span class="c1">#=&gt; 3 + 3 = 6</span>
</span><span class='line'>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<h4>Numeric Operators</h4>

<p>Most of the operatoirs in Ruby are similar to those in other common languages like + for addition, - for subtraction, * for multiplication, / for division.</p>

<p>Note however that Ruby does not support increment(++) and decrement(&#8211;) operators.
 Note that <strong> ** </strong> is the exponentiation operator.</p>

<figure class='code'><figcaption><span>Exponentation in Ruby </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'> <span class="mi">2</span> <span class="o">**</span> <span class="mi">3</span>
</span><span class='line'>
</span><span class='line'> <span class="c1">#=&gt; 8</span>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<p> Operators can also serves as methods. * can be used for repetition and + can be used for string concatenation.</p>

<figure class='code'><figcaption><span>String Repetition in Ruby </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'> <span class="s2">&quot;Hello &quot;</span> <span class="o">*</span> <span class="mi">3</span>
</span><span class='line'>
</span><span class='line'> <span class="c1">#=&gt; Hello Hello Hello</span>
</span><span class='line'>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>




<blockquote><p>Ruby does not support increment and decrement operators.</p></blockquote>


<h4>String Methods</h4>

<p>The +  symbol and &lt;&lt;  symbol are used to <strong>concatenate</strong> strings.</p>

<figure class='code'><figcaption><span>String Concatenation  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'> <span class="s2">&quot;Hello&quot;</span> <span class="o">+</span> <span class="s2">&quot;World&quot;</span>
</span><span class='line'> <span class="c1">#=&gt; &quot;HelloWorld&quot; </span>
</span><span class='line'> <span class="s2">&quot;Hello&quot;</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;World&quot;</span>
</span><span class='line'> <span class="c1">#=&gt; &quot;HelloWorld&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>There are many <a href="http://ruby-doc.org/core-2.0/String.html">String</a> methods in Ruby.</p>

<p>Ruby method names can end with an exclamation mark(a bang or mutator method) or a question mark(a predicate method). A bang method changes the object in place. A predicate method indicates that a method is boolean: returns true or false.</p>

<p>  <blockquote><p>A bang method is a method name ending with a ! and changes the the object in place.</p></blockquote></p>

<figure class='code'><figcaption><span>Bang Method  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="n">str</span> <span class="o">=</span> <span class="s2">&quot;String&quot;</span>
</span><span class='line'>  <span class="c1">#=&gt; &quot;String&quot; </span>
</span><span class='line'>  <span class="n">str</span><span class="o">.</span><span class="n">upcase</span>
</span><span class='line'>  <span class="c1">#=&gt; &quot;STRING&quot; </span>
</span><span class='line'>  <span class="n">str</span> <span class="c1"># str is not modified</span>
</span><span class='line'>  <span class="o">=&gt;</span> <span class="s2">&quot;String&quot;</span>
</span><span class='line'>  <span class="n">str</span><span class="o">.</span><span class="n">upcase!</span>
</span><span class='line'>  <span class="c1">#=&gt; &quot;STRING&quot; </span>
</span><span class='line'>  <span class="n">str</span> <span class="c1"># str has been modified in place</span>
</span><span class='line'>  <span class="c1">#=&gt; &quot;STRING</span>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<p>A few String methods are summarized below.</p>

<p>  <strong>capitalize</strong> Convert first letter to uppercase and the rest to lowercase<br/>
  <strong>chop</strong> Removes the last character<br/>
  <strong>chomp</strong> removes a new line fro mthe right end, if there is one <br/>
  <strong>upcase</strong> converts all of the letters in the object to uppercase<br/>
  <strong>downcase</strong> converts all of the letters<br/>
  <strong>strip</strong> Removes the spaces on both ends<br/>
  <strong>lstrip</strong> Removes the spaces on the left end<br/>
  <strong>rstrip</strong> Removes the spaces on the right end<br/>
  <strong>reverse</strong> Reverse the characters of the string<br/>
  <strong>swapcase</strong> Converts all uppercase letters to lowercase and all lowercase letters to uppercase</p>

<p> Strings can also be accessed by an index where 0 is the first position. If a negative index is used, the index starts at the back where the last character is -1.
 Strings can also be index like [index,length].</p>

<figure class='code'><figcaption><span>String Indexing Examples  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'> <span class="s2">&quot;12345&quot;</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
</span><span class='line'> <span class="c1">#=&gt; 1</span>
</span><span class='line'>
</span><span class='line'> <span class="s2">&quot;12345&quot;</span><span class="o">[-</span><span class="mi">5</span><span class="o">]</span>
</span><span class='line'> <span class="c1">#=&gt; 1</span>
</span><span class='line'>
</span><span class='line'> <span class="s2">&quot;12345&quot;</span><span class="o">[-</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="o">]</span>
</span><span class='line'> <span class="c1">#=&gt; &quot;123&quot; </span>
</span><span class='line'>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<h3><a id="io"></a> Input and Output</h3>

<p>Sometimes you may want to work with Ruby on the command line.
One way is to run <strong>irb</strong> on the command line to start the Interactive Ruby Shell and then experimenting with Ruby in the console.
You can execute a script by running  <strong>ruby</strong> <em>scriptname</em>
The <strong>-c</strong> flag can be used to check syntax. For a full set of flags run <strong>man ruby</strong>
You can also execute a script by  putting <strong>#!/usr/bin/env ruby</strong> at the top of your script and running your script like so <strong>./scriptname</strong>
If you use this method make sure that your script is executable by running <strong>chmod +x</strong>. Generally ruby scripts end with the extension <strong>.rb</strong></p>

<h4>Output</h4>

<p><strong>print</strong> is used to output a string.
<strong>puts</strong> behaves like print but adds a newline to the end of output.</p>

<figure class='code'><figcaption><span>Output Exaple  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'> <span class="nb">print</span> <span class="s2">&quot;Hello&quot;</span>
</span><span class='line'> <span class="c1">#Hello =&gt; nil </span>
</span><span class='line'> <span class="nb">puts</span> <span class="s2">&quot;Hello&quot;</span>
</span><span class='line'> <span class="c1">#Hello</span>
</span><span class='line'> <span class="c1">#=&gt; nil </span>
</span></code></pre></td></tr></table></div></figure>




<blockquote><p>puts behaves like print but adds a newline to the end of output</p></blockquote>


<h4>Input</h4>

<p><strong>gets</strong> is used to retrieve a line of input from the keyboard.
The parsed input is a string, and you can use string methods to filter the string.
Use methods such as <strong>to_i</strong> or <strong>to_f</strong> to convert the input into an integer or float respectively.</p>

<figure class='code'><figcaption><span>Input Example  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">num</span> <span class="o">=</span> <span class="nb">gets</span><span class="o">.</span><span class="n">chomp</span><span class="o">.</span><span class="n">to</span><span class="p">\</span><span class="n">_i</span>
</span><span class='line'><span class="c1">#removes newline character from input and converts input to an integer</span>
</span><span class='line'><span class="c1">#=&gt; 9123 </span>
</span><span class='line'><span class="c1"># Replace \_ with underscore. Need \ to escape underscore in markdown.</span>
</span></code></pre></td></tr></table></div></figure>


<h3><a id="control_statements"></a> Control Statements</h3>

<p>Control Statements are used to control execution flow of a program.</p>

<h4>Control Expressions</h4>

<p>Control Expressions are logical expressions used to for control statments. A relational operator has two operands and an operator
Relational Operator</p>

<p><strong>==</strong> equals<br/>
<strong>!=</strong> not equals<br/>
<strong>&lt;</strong> less than<br/>
<strong>></strong> greater than<br/>
<strong>&lt;=</strong> less than or equal to<br/>
<strong>>=</strong> greater than or equal to<br/>
<strong>&lt;=></strong> Comparator: for a &lt;=> b returns 1 if a > b , -1 if a &lt; b, and  0 if a == b This operator is also very help for sorting.<br/>
<strong>eql?</strong> returns true if parameter and reciever object have same type and value. <br/>
<strong>equal?</strong> returns true if parameter is the same as the reciever object. Effectly checks for same references.</p>

<figure class='code'><figcaption><span>Relational Operators  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="s2">&quot;thunderstorm&quot;</span><span class="o">.</span><span class="n">eql?</span><span class="p">(</span><span class="s2">&quot;thunderstorm&quot;</span><span class="p">)</span>
</span><span class='line'> <span class="c1">#=&gt; true </span>
</span><span class='line'>
</span><span class='line'> <span class="s2">&quot;thunderstorm&quot;</span><span class="o">.</span><span class="n">equal?</span><span class="p">(</span><span class="s2">&quot;thunderstorm&quot;</span><span class="p">)</span>
</span><span class='line'> <span class="c1">#=&gt; false </span>
</span><span class='line'> <span class="c1"># both thunderstorms refer to different objects</span>
</span><span class='line'>
</span><span class='line'> <span class="n">str</span> <span class="o">=</span> <span class="s2">&quot;thunderstorm&quot;</span>
</span><span class='line'> <span class="c1">#=&gt; &quot;thunderstorm&quot; </span>
</span><span class='line'> <span class="n">str2</span> <span class="o">=</span> <span class="n">str</span>
</span><span class='line'> <span class="c1">#=&gt; &quot;thunderstorm&quot; </span>
</span><span class='line'> <span class="n">str</span><span class="o">.</span><span class="n">equal?</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
</span><span class='line'> <span class="c1">#=&gt;true</span>
</span></code></pre></td></tr></table></div></figure>


<h5>Operator Precedence and associativity</h5>

<p><strong>Operator precendence</strong> specifies the order in which operations should be carried out.
The following operators are listed in precedence from greatest to least (in descending order).
Operators on the same line have the same precedence. <strong>Associativity</strong> tells you how to evaluate operations
if two or more operators have the same precendence either start evaluating from the left or right. If operators
are nonassociative that means that these operators cannot associative with themselves.</p>

<figure class='code'><figcaption><span>Associativity Example </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="mi">3</span> <span class="o">+</span> <span class="mi">7</span> <span class="o">-</span> <span class="mi">4</span>
</span><span class='line'> <span class="c1">#=&gt; 6</span>
</span><span class='line'> <span class="c1">#Left Associativity</span>
</span><span class='line'> <span class="c1">#(3 + 7) -4</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Nonassociative Example  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'> <span class="mi">1</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="mi">3</span>
</span><span class='line'> <span class="c1"># &lt; is a nonassociative operator</span>
</span><span class='line'> <span class="c1">#NoMethodError: undefined method `&lt;&#39; for true:TrueClass</span>
</span></code></pre></td></tr></table></div></figure>


<p>** <strong>Right</strong></p>

<figure class='code'><figcaption><span>Operator Precedence  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'> <span class="mi">2</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">3</span>
</span><span class='line'>
</span><span class='line'> <span class="c1">#=&gt; 256</span>
</span><span class='line'> <span class="c1"># 2 ** ( 2 ** 3) =&gt; 2 ** 8</span>
</span></code></pre></td></tr></table></div></figure>


<p>!, unary + and - <strong>Right</strong><br/>
Here is a pretty interesting article on how to define your own <a href="http://www.rubyinside.com/rubys-unary-operators-and-how-to-redefine-their-functionality-5610.html">unary operator</a></p>

<figure class='code'><figcaption><span>Unary Operators </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">--------+-+</span> <span class="mi">3</span>
</span><span class='line'><span class="c1">#=&gt; -3</span>
</span><span class='line'><span class="o">-+</span><span class="mi">3</span>
</span><span class='line'><span class="c1">#=&gt; -3</span>
</span></code></pre></td></tr></table></div></figure>


<p>*, /, % <strong>Left</strong><br/>
+, - <strong>Left</strong> <br/>
&amp; <strong>Left</strong><br/>
> , &lt;, >= , &lt;= <strong>Nonassociative</strong>  <br/>
==, !=, &lt;=> <strong>Nonassociative</strong><br/>
&amp;&amp; <strong>Left</strong>  <br/>
|| <strong>Left</strong>  <br/>
=, +=, -=, *=, **=, /=, %=, &amp;=, &amp;&amp;=, ||= <strong>Right</strong>  <br/>
not <strong>Right</strong><br/>
or, and <strong>Left</strong></p>

<blockquote><p>and and or are control-flow modifiers like if and unless</p></blockquote>


<p>More about <a href="http://devblog.avdi.org/2010/08/02/using-and-and-or-in-ruby/">using and vs &amp;&amp;</a></p>

<h4>Selection statements</h4>

<p>Selection statements are used for conditional branching of execution.</p>

<figure class='code'><figcaption><span>Selection Statements  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>    <span class="k">if</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">1</span>
</span><span class='line'>      <span class="nb">puts</span> <span class="s2">&quot;one&quot;</span>
</span><span class='line'>    <span class="k">elsif</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">2</span>
</span><span class='line'>      <span class="nb">puts</span> <span class="s2">&quot;two&quot;</span>
</span><span class='line'>    <span class="k">elsif</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">3</span>
</span><span class='line'>      <span class="nb">puts</span> <span class="s2">&quot;three&quot;</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>      <span class="nb">puts</span> <span class="s2">&quot;I don&#39;t recognize this number&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">case</span> <span class="n">num</span>
</span><span class='line'>    <span class="k">when</span> <span class="mi">1</span> <span class="k">then</span> <span class="nb">puts</span> <span class="s2">&quot;one&quot;</span>
</span><span class='line'>    <span class="k">when</span>  <span class="mi">2</span>
</span><span class='line'>      <span class="nb">puts</span> <span class="s2">&quot;two&quot;</span>
</span><span class='line'>    <span class="k">when</span> <span class="mi">3</span>
</span><span class='line'>      <span class="nb">puts</span> <span class="s2">&quot;three&quot;</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>       <span class="nb">puts</span> <span class="s2">&quot;I don&#39;t recognize this number&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<blockquote><p>The case construct is the equivalent of a switch statement in other programming languages.</p></blockquote>


<p>The <a href="http://stackoverflow.com/questions/948135/how-to-write-a-switch-statement-in-ruby">then</a> keyword following the when clauses can be replaced with a newline.</p>

<h4>Loop Statements</h4>

<p>Loop of statements repeatedly executed until a terminiting condition.</p>

<figure class='code'><figcaption><span>Loops in Ruby </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'> <span class="n">i</span> <span class="o">=</span> <span class="mi">10</span>
</span><span class='line'> <span class="kp">loop</span> <span class="k">do</span>
</span><span class='line'>   <span class="n">i</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span class='line'>   <span class="k">next</span> <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span> <span class="c1">#continue to next iteration if odd</span>
</span><span class='line'>   <span class="nb">print</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="c1">#string interpolation</span>
</span><span class='line'>    <span class="k">break</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="c1">#terminating condition that breaks out of loop</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">#=&gt; 86420</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">for</span> <span class="n">num</span> <span class="k">in</span> <span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="mi">10</span> <span class="c1">#up to but not including (exclusive)</span>
</span><span class='line'>      <span class="nb">print</span> <span class="n">num</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">#=&gt; 123456789</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">for</span> <span class="n">num</span> <span class="k">in</span> <span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="mi">10</span> <span class="c1">#up to including (inclusive)</span>
</span><span class='line'>      <span class="nb">print</span> <span class="n">num</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">#=&gt; 12345678910</span>
</span></code></pre></td></tr></table></div></figure>


<p> <blockquote><p>&#8230; and .. are range operators for exclusive and inclusive ranges.</p></blockquote></p>

<p> <blockquote><p>next is the equivalent of a continue statement in other programming languages. The program continues to the next iteration of the loop.</p></blockquote></p>

<p>Although if statements are fairly common in Ruby Applications, looping constructs are rarely used. Block and iterators often take their place.</p>

<blockquote><p>In Ruby, looping constructs are rarely used. Instead, block and iterators take their place.</p></blockquote>


<h3><a id="blocks"></a> Code Blocks and Iterators</h3>

<p><strong>Code Blocks</strong> are groups of code between <strong>do &#8230; end</strong> or <strong>curly braces {}</strong>. By convention <strong>do&#8230;end</strong> is used for multiline blocks where as {} is used for single line blocks.
<a href="http://stackoverflow.com/questions/5587264/do-end-vs-curly-braces-for-blocks-in-ruby">do/end vs curly braces</a></p>

<p><strong>Iterators</strong> are methods used to invoke blocks repeatedly.
Note that blocks can accept parameters that are delimited like so <strong>|parameter|</strong></p>

<figure class='code'><figcaption><span>times Iterator </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="mi">10</span><span class="o">.</span><span class="n">times</span><span class="p">{</span><span class="o">|</span><span class="n">x</span><span class="o">|</span> <span class="nb">puts</span> <span class="n">x</span><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># 0</span>
</span><span class='line'><span class="c1"># 1 </span>
</span><span class='line'><span class="c1"># 2</span>
</span><span class='line'><span class="c1"># 3</span>
</span><span class='line'><span class="c1"># 4</span>
</span><span class='line'><span class="c1"># 5</span>
</span><span class='line'><span class="c1"># 6</span>
</span><span class='line'><span class="c1"># 7</span>
</span><span class='line'><span class="c1"># 8</span>
</span><span class='line'><span class="c1"># 9</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>each Iterator  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">fruits</span> <span class="o">=</span> <span class="o">[</span><span class="s2">&quot;apple&quot;</span><span class="p">,</span><span class="s2">&quot;rasberry&quot;</span><span class="p">,</span><span class="s2">&quot;lemon&quot;</span><span class="p">,</span><span class="s2">&quot;cranberry&quot;</span><span class="o">]</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># each element is fruit is passed as an argument to the block</span>
</span><span class='line'><span class="c1"># fruit is variable name of  the parameter in the block</span>
</span><span class='line'><span class="n">fruits</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span><span class="o">|</span><span class="n">fruit</span><span class="o">|</span> <span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">fruit</span><span class="si">}</span><span class="s2"> pie&quot;</span><span class="p">}</span>
</span><span class='line'><span class="c1"># apple pie</span>
</span><span class='line'><span class="c1"># rasberry pie</span>
</span><span class='line'><span class="c1"># lemon pie</span>
</span><span class='line'><span class="c1"># cranberry pie</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># returns the fruits array</span>
</span><span class='line'><span class="c1"># =&gt; [&quot;apple&quot;, &quot;rasberry&quot;, &quot;lemon&quot;, &quot;cranberry&quot;] </span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Iterating over Hashes  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">ratings</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="ss">memento</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span><span class='line'>  <span class="ss">primer</span><span class="p">:</span> <span class="mi">3</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span>
</span><span class='line'>  <span class="ss">matrix</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span><span class='line'>  <span class="ss">skyfall</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span><span class='line'>  <span class="ss">uhf</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">good</span> <span class="o">=</span> <span class="n">ratings</span><span class="o">.</span><span class="n">select</span> <span class="p">{</span><span class="o">|</span><span class="n">k</span><span class="p">,</span><span class="n">ratings</span><span class="o">|</span> <span class="n">ratings</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">}</span>
</span><span class='line'><span class="c1">#=&gt; {:primer=&gt;3.5, :skyfall=&gt;4} </span>
</span><span class='line'><span class="c1">#=&gt; is equivalent to { primer: 3.5, skyfall: 4}</span>
</span><span class='line'>
</span><span class='line'><span class="n">ratings</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="ss">memento</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span><span class='line'>  <span class="ss">primer</span><span class="p">:</span> <span class="mi">3</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span>
</span><span class='line'>  <span class="ss">skyfall</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span><span class='line'>  <span class="ss">uhf</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="n">ratings</span><span class="o">.</span><span class="n">each</span><span class="p">{</span><span class="o">|</span><span class="n">key</span><span class="p">,</span><span class="n">value</span><span class="o">|</span> <span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">key</span><span class="o">.</span><span class="n">capitalize</span><span class="si">}</span><span class="s2"> Ratings: </span><span class="si">#{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Memento Ratings: 3</span>
</span><span class='line'><span class="c1"># Primer Ratings: 3.5</span>
</span><span class='line'><span class="c1"># Skyfall Ratings: 4</span>
</span><span class='line'><span class="c1"># Uhf Ratings: 1</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>collect</strong> is an iterator that applies the block on each element of the array.
It creates a new array containing the values returned by the block.
If you used the bang method it modifies the array in place.</p>

<figure class='code'><figcaption><span>collect Iterator  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>    <span class="n">fruits</span> <span class="o">=</span> <span class="o">[</span><span class="s2">&quot;apple&quot;</span><span class="p">,</span><span class="s2">&quot;rasberry&quot;</span><span class="p">,</span><span class="s2">&quot;lemon&quot;</span><span class="p">,</span><span class="s2">&quot;cranberry&quot;</span><span class="o">]</span>
</span><span class='line'><span class="c1">#=&gt; [&quot;apple&quot;, &quot;rasberry&quot;, &quot;lemon&quot;, &quot;cranberry&quot;] </span>
</span><span class='line'>   <span class="n">fruits</span><span class="o">.</span><span class="n">collect</span> <span class="p">{</span><span class="o">|</span><span class="n">fruit</span><span class="o">|</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">fruit</span><span class="si">}</span><span class="s2"> pie&quot;</span><span class="p">}</span>
</span><span class='line'><span class="c1">#=&gt; [&quot;apple pie&quot;, &quot;rasberry pie&quot;, &quot;lemon pie&quot;, &quot;cranberry pie&quot;] </span>
</span><span class='line'><span class="c1">#note that a new array was created and fruits has stayed the same</span>
</span><span class='line'>   <span class="n">fruits</span>
</span><span class='line'><span class="c1">#=&gt; [&quot;apple&quot;, &quot;rasberry&quot;, &quot;lemon&quot;, &quot;cranberry&quot;] </span>
</span><span class='line'>   <span class="n">fruits</span><span class="o">.</span><span class="n">collect!</span> <span class="p">{</span><span class="o">|</span><span class="n">fruit</span><span class="o">|</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">fruit</span><span class="si">}</span><span class="s2"> pie&quot;</span><span class="p">}</span>
</span><span class='line'><span class="c1">#=&gt; [&quot;apple pie&quot;, &quot;rasberry pie&quot;, &quot;lemon pie&quot;, &quot;cranberry pie&quot;] </span>
</span><span class='line'><span class="c1">#note that because we used the bang method fruits has now changed</span>
</span><span class='line'>    <span class="n">fruits</span>
</span><span class='line'><span class="c1">#=&gt; [&quot;apple pie&quot;, &quot;rasberry pie&quot;, &quot;lemon pie&quot;, &quot;cranberry pie&quot;] </span>
</span><span class='line'>    <span class="n">fruits</span><span class="o">.</span><span class="n">collect</span> <span class="p">{</span><span class="o">|</span><span class="n">fruit</span><span class="o">|</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">fruit</span><span class="si">}</span><span class="s2"> pie&quot;</span><span class="p">}</span>
</span><span class='line'><span class="c1">#=&gt; [&quot;apple pie pie&quot;, &quot;rasberry pie pie&quot;, &quot;lemon pie pie&quot;, &quot;cranberry pie pie&quot;] </span>
</span></code></pre></td></tr></table></div></figure>


<p>Methods can transfer control to a block and back again. This is can be done using the <strong>yield</strong> method, which invokes the block with an optional parameter.</p>

<figure class='code'><figcaption><span>Yield </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">yield_num</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="s2">&quot;inside of method yield_num&quot;</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="s2">&quot;Yield!&quot;</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">yield</span> <span class="n">num</span>
</span><span class='line'>  <span class="c1">#passing your own number directly to the block</span>
</span><span class='line'>  <span class="k">yield</span> <span class="mi">20</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">yield_num</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">num</span><span class="o">|</span> <span class="nb">puts</span> <span class="s2">&quot;Your lucky number is </span><span class="si">#{</span><span class="n">num</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#=&gt; inside of method yield_num</span>
</span><span class='line'><span class="c1">#=&gt; Yield!</span>
</span><span class='line'><span class="c1">#=&gt; Your lucky number is 5</span>
</span><span class='line'><span class="c1">#=&gt; Your lucky number is 20</span>
</span></code></pre></td></tr></table></div></figure>




<blockquote><p>Methods can transfer control to a block and back again. This is known as the yield method, which invokes the block with an optional parameter.</p></blockquote>


<h3><a id ="procs_and_lambdas"></a> Procs and Lambdas</h3>

<h4>TODO</h4>

<h4>Proc</h4>

<p><strong>Procs</strong> are full-fledged objects, so they have all the powers and abilities of objects. (Blocks do not.)</p>

<p>Unlike blocks, <strong>procs can be called over and over without rewriting them</strong>. This prevents you from having to retype the contents of your block every time you need to execute a particular bit of code.</p>

<p>http://www.robertsosinski.com/2008/12/21/understanding-ruby-blocks-procs-and-lambdas/
http://stackoverflow.com/questions/1435743/why-does-explicit-return-make-a-difference-in-a-proc
http://ablogaboutcode.com/2012/01/04/the-ampersand-operator-in-ruby/</p>

<h4>lambda</h4>

<p>First, a lambda checks the number of arguments passed to it, while a proc does not. This means that a lambda will throw an error if you pass it the wrong number of arguments, whereas a proc will ignore unexpected arguments and assign nil to any that are missing.</p>

<p>Second, when a lambda returns, it passes control back to the calling method; when a proc returns, it does so immediately, without going back to the calling method.</p>

<h3><a id="arrays"></a> Fundamentals of Arrays</h3>

<p>An <strong>array</strong> is a series of elements. If you have arrays of arrays this is known as a <strong>multi-dimensional array</strong>. Array elements are indexed by integers with the first element being 0.</p>

<p>Ruby arrays differs from more traditional langauges such as C,C++, and Java because the lenght of an array is dynamic. They can shrinkand grown during program execution. If you&#8217;ve worked with C++, this is the same behaviior as a vector.</p>

<p>Generally arrays must store homogenous elements (elements of the same type). However Ruby arrays store heterogenous elements or a mix of elements.</p>

<figure class='code'><figcaption><span>Arrays  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">Array</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span><span class='line'><span class="c1">#=&gt;[nil, nil, nil, nil, nil] </span>
</span><span class='line'>
</span><span class='line'><span class="no">Arr</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s2">&quot;fivetimes&quot;</span><span class="p">)</span>
</span><span class='line'><span class="c1">#=&gt; [&quot;fivetimes&quot;, &quot;fivetimes&quot;, &quot;fivetimes&quot;, &quot;fivetimes&quot;, &quot;fivetimes&quot;] </span>
</span><span class='line'>
</span><span class='line'><span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">]</span>
</span><span class='line'><span class="c1">#=&gt; [1, 2] </span>
</span><span class='line'>
</span><span class='line'><span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">][</span><span class="mi">0</span><span class="o">]</span> <span class="c1"># get the first element from array</span>
</span><span class='line'><span class="c1">#=&gt; 1 </span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="nb">Array</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'><span class="c1"># =&gt; [[1, 2], [1, 2], [1, 2], [1, 2], [1, 2]] </span>
</span></code></pre></td></tr></table></div></figure>


<h4>for-in</h4>

<p>One method to loop over an array is to use the for-in statement.</p>

<figure class='code'><figcaption><span>for-in </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">arr</span> <span class="o">=</span> <span class="o">[</span><span class="s2">&quot;one&quot;</span><span class="p">,</span><span class="s2">&quot;two&quot;</span><span class="p">,</span><span class="s2">&quot;three&quot;</span><span class="p">,</span><span class="s2">&quot;four&quot;</span><span class="o">]</span>
</span><span class='line'>
</span><span class='line'><span class="k">for</span> <span class="n">x</span> <span class="k">in</span> <span class="n">arr</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="n">x</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#=&gt;one</span>
</span><span class='line'><span class="c1">#=&gt;two</span>
</span><span class='line'><span class="c1">#=&gt;three</span>
</span><span class='line'><span class="c1">#=&gt;four</span>
</span><span class='line'>
</span><span class='line'><span class="n">multi</span> <span class="o">=</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'><span class="c1"># =&gt; [[1, 2], [1, 2], [1, 2], [1, 2], [1, 2]] </span>
</span><span class='line'><span class="k">for</span> <span class="n">arr</span> <span class="k">in</span> <span class="n">multi</span> <span class="c1"># get nested array</span>
</span><span class='line'>  <span class="nb">print</span> <span class="s2">&quot;[ &quot;</span>
</span><span class='line'>  <span class="k">for</span> <span class="n">val</span> <span class="k">in</span> <span class="n">arr</span> <span class="c1"># get values from nested array</span>
</span><span class='line'>    <span class="nb">print</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">val</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="s2">&quot;]&quot;</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#=&gt; [ 1 2 ]</span>
</span><span class='line'><span class="c1">#=&gt; [ 1 2 ]</span>
</span><span class='line'><span class="c1">#=&gt; [ 1 2 ]</span>
</span><span class='line'><span class="c1">#=&gt; [ 1 2 ]</span>
</span><span class='line'><span class="c1">#=&gt; [ 1 2 ]</span>
</span></code></pre></td></tr></table></div></figure>


<p><a href="http://ruby-doc.org/core-2.0/Array.html">Arrays</a> have an assortment of methods. Some common methods
are demoed below.</p>

<figure class='code'><figcaption><span>Array methods  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">]</span> <span class="o">+</span> <span class="o">[</span><span class="mi">13</span><span class="o">]</span> <span class="c1"># concatenate the arrays</span>
</span><span class='line'><span class="c1">#=&gt; [1, 2, 3, 4, 13] </span>
</span><span class='line'>
</span><span class='line'><span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">]</span> <span class="o">&lt;&lt;</span> <span class="o">[</span><span class="mi">13</span><span class="o">]</span> <span class="c1"># append [13] to array</span>
</span><span class='line'><span class="c1">#=&gt; [1, 2, 3, 4, [13]] </span>
</span><span class='line'>
</span><span class='line'><span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">]</span> <span class="o">&lt;&lt;</span> <span class="mi">13</span>   <span class="c1"># append 13 to array</span>
</span><span class='line'><span class="c1">#=&gt; [1, 2, 3, 4, 13] </span>
</span><span class='line'>
</span><span class='line'><span class="n">arr</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">]</span>
</span><span class='line'><span class="n">arr</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="c1"># adds 13 to right side of array</span>
</span><span class='line'><span class="c1">#=&gt; [1, 2, 3, 4, 13] </span>
</span><span class='line'>
</span><span class='line'><span class="n">arr</span><span class="o">.</span><span class="n">pop</span> <span class="c1"># removes first element from right side</span>
</span><span class='line'><span class="c1">#=&gt; 13</span>
</span><span class='line'>
</span><span class='line'><span class="n">arr</span>
</span><span class='line'><span class="c1">#=&gt; [1,2,3,4] </span>
</span><span class='line'><span class="c1"># 13 is gone!</span>
</span><span class='line'>
</span><span class='line'><span class="n">arr</span><span class="o">.</span><span class="n">unshift</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="c1"># adds 13 to left side of array</span>
</span><span class='line'><span class="c1">#=&gt; [13, 1, 2, 3, 4]</span>
</span><span class='line'>
</span><span class='line'><span class="n">arr</span><span class="o">.</span><span class="n">shift</span> <span class="c1">#remove first element from left side</span>
</span><span class='line'><span class="c1">#=&gt; 13 </span>
</span><span class='line'><span class="n">arr</span>
</span><span class='line'><span class="c1">#=&gt; [1, 2, 3, 4] </span>
</span><span class='line'>
</span><span class='line'><span class="n">arr</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#remove 2 more elements from left side</span>
</span><span class='line'><span class="c1">#=&gt; [1, 2] </span>
</span><span class='line'><span class="n">arr</span>
</span><span class='line'><span class="c1">#=&gt; [3, 4]</span>
</span><span class='line'>
</span><span class='line'><span class="n">arr</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">]</span>
</span><span class='line'><span class="n">arr</span><span class="o">.</span><span class="n">reverse</span>
</span><span class='line'><span class="c1">#=&gt; [4, 3, 2, 1] </span>
</span><span class='line'><span class="n">arr</span>
</span><span class='line'><span class="c1">#=&gt; [1, 2, 3, 4] #note that the original array has not changed </span>
</span><span class='line'><span class="n">arr</span><span class="o">.</span><span class="n">reverse!</span>
</span><span class='line'><span class="c1">#=&gt; [4, 3, 2, 1] </span>
</span><span class='line'> <span class="n">arr</span>
</span><span class='line'><span class="c1">#=&gt; [4, 3, 2, 1] #note that the original array changed because we called a ! method </span>
</span></code></pre></td></tr></table></div></figure>


<p>Arrays can also be treated as <a href="http://mathworld.wolfram.com/Set.html">sets</a>
The &amp; operator is used for set intersection, -, for set difference, and |, for set union</p>

<figure class='code'><figcaption><span>Sets </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">]</span> <span class="o">&amp;</span> <span class="o">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="o">]</span> <span class="c1"># set intersect</span>
</span><span class='line'><span class="c1">#=&gt; [2] </span>
</span><span class='line'>
</span><span class='line'><span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">]</span> <span class="o">-</span> <span class="o">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="o">]</span> <span class="c1"># set difference</span>
</span><span class='line'><span class="c1">#=&gt; [1, 3, 4] </span>
</span><span class='line'>
</span><span class='line'><span class="o">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">]</span> <span class="o">|</span> <span class="o">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="o">]</span> <span class="c1"># set union</span>
</span><span class='line'><span class="c1">#=&gt; [1, 2, 3, 4, 45, 6, 7, 8, 9] </span>
</span></code></pre></td></tr></table></div></figure>


<h3><a id="hash"></a> Hashes</h3>

<p>Arrays are indexed by integers.
There is another key, value collection called a <strong>hash</strong> where an object is reference by another object known as a <strong>symbol</strong>.
If you&#8217;re coming from a background in JavaScript, PHP, you maybe used to acessing hashes using strings.</p>

<figure class='code'><figcaption><span>Hashes  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># this is the old syntax for a ruby symbols</span>
</span><span class='line'><span class="c1"># symbols are declared as :symbol</span>
</span><span class='line'><span class="n">oldnumhash</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="ss">:four</span> <span class="o">=&gt;</span> <span class="mi">4</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">:five</span> <span class="o">=&gt;</span>  <span class="mi">5</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">:six</span> <span class="o">=&gt;</span> <span class="mi">6</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">oldnumhash</span><span class="o">.</span><span class="n">each</span><span class="p">{</span><span class="o">|</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="o">|</span> <span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">k</span><span class="si">}</span><span class="s2"> maps to </span><span class="si">#{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}</span>
</span><span class='line'><span class="c1">#=&gt; four maps to 4</span>
</span><span class='line'><span class="c1">#=&gt; five maps to 5</span>
</span><span class='line'><span class="c1">#=&gt; six maps to 6</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Ruby 1.9 introduced an even simpler syntax</span>
</span><span class='line'><span class="c1"># Notice that this the colon (:) comes right after the key</span>
</span><span class='line'><span class="n">numhash</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="ss">one</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">two</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">three</span><span class="p">:</span> <span class="mi">3</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nb">puts</span> <span class="n">numhash</span><span class="o">[</span><span class="ss">:one</span><span class="o">]</span>
</span><span class='line'><span class="c1">#=&gt; 1</span>
</span><span class='line'><span class="nb">puts</span> <span class="n">numhash</span><span class="o">[</span><span class="ss">:two</span><span class="o">]</span>
</span><span class='line'><span class="c1">#=&gt; 2</span>
</span><span class='line'><span class="nb">puts</span> <span class="n">numhash</span><span class="o">[</span><span class="ss">:three</span><span class="o">]</span>
</span><span class='line'><span class="c1">#=&gt; 3</span>
</span></code></pre></td></tr></table></div></figure>


<p>Here is a good description of why symbols are used as hash keys in Ruby</p>

<blockquote><p>&#8220;Using symbols not only saves time when doing comparisons, but also saves memory, because they are only stored once.</p><p>Symbols in Ruby are basically &#8220;immutable strings&#8221; . That means that they can not be changed, and it implies that the same symbol when referenced many times throughout your source code, is always stored as the same entity, e.g. has the same object id.</p><p>Strings on the other hand are mutable, they can be changed anytime. This implies that Ruby needs to store each string you mention throughout your source code in it&#8217;s separate entity, e.g. if you have a string &#8220;name&#8221; multiple times mentioned in your source code, Ruby needs to store these all in separate String objects, because they might change later on (that&#8217;s the nature of a Ruby string).</p><p>If you use a string as a Hash key, Ruby needs to evaluate the string and look at it&#8217;s contents (and compute a hash function on that) and compare the result against the (hashed) values of the keys which are already stored in the Hash.</p><p>If you use a symbol as a Hash key, it&#8217;s implicit that it&#8217;s immutable, so Ruby can basically just do a comparison of the (hash function of the) object-id against the (hashed) object-ids of keys which are already stored in the Hash. (much faster)</p><p>Notes:</p><p>If you do string comparisons, Ruby can compare symbols just by their object ids, without having to evaluate them. That&#8217;s much faster than comparing strings, which need to be evaluated.</p><p>If you access a hash, Ruby always applies a hash-function to compute a &#8220;hash-key&#8221; from whatever key you use. You can imagine something like an MD5-hash. And then Ruby compares those &#8220;hashed keys&#8221; against each other.&#8221;</p></blockquote>


<p><strong>Source:</strong>  <a href="http://stackoverflow.com/users/677684/tilo">tilo&#8217;s</a> answer from <a href="http://stackoverflow.com/questions/8189416/why-use-symbols-as-hash-keys-in-ruby">http://stackoverflow.com/questions/8189416/why-use-symbols-as-hash-keys-in-ruby</a></p>

<p>Each object is identified by an integer which can be retrieved using the method <a href="http://ruby-doc.org/core-2.0/Object.html#method-i-object_id">.object_id</a>.
As mentioned previously <strong>only one copy of a symbol exists at a given time</strong>, meaning that there exists only one object id for that symbol.</p>

<figure class='code'><figcaption><span>Object id  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># note that these string objects are different instances </span>
</span><span class='line'>  <span class="nb">puts</span> <span class="s2">&quot;string&quot;</span><span class="o">.</span><span class="n">object_id</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="s2">&quot;string&quot;</span><span class="o">.</span><span class="n">object_id</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># these ids are different</span>
</span><span class='line'><span class="c1">#=&gt;79341770</span>
</span><span class='line'><span class="c1">#=&gt;79341710</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1"># note that only one copy of the symbol :symbol exists at a time</span>
</span><span class='line'><span class="nb">puts</span> <span class="ss">:symbol</span><span class="o">.</span><span class="n">object_id</span>
</span><span class='line'><span class="nb">puts</span> <span class="ss">:symbol</span><span class="o">.</span><span class="n">object_id</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># these ids are the same</span>
</span><span class='line'><span class="c1">#=&gt;192008</span>
</span><span class='line'><span class="c1">#=&gt;192008</span>
</span></code></pre></td></tr></table></div></figure>


<h3><a id="methods"></a> Methods</h3>

<h4>TODO</h4>

<h3><a id="sorting"></a> Sorting</h3>

<h4>TODO</h4>

<h3><a id="pattern"></a> Pattern Matching</h3>

<h4>TODO</h4>

<h3><a id="classes"></a> Classes</h3>

<h4>TODO</h4>

<h3><a id="modules"></a> Modules</h3>

<h4>TODO</h4>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/03/29/ahoy-octopress/">Ahoy! Octopress</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-29T18:10:00-07:00" pubdate data-updated="true">Mar 29<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Ay mate! I recently decided to start blogging about code with <a href="http://octopress.org">octopress</a> as my blogging engine. This blog will focus on documenting my coding ventures. I&#8217;ve encountered other file based cms(content management systems) such as  <a href="http://getkirby.com">kirby</a> and <a href="http://www.staceyapp.com">stacey</a> (which run on PHP as opposed to Ruby), but ultimately decided to work with octopress because this framework is designed for Jekyll, the blog aware static site generator that powers <a href="pages.github.com">Github Pages</a> (so this site can be hosted on github). As an added bonus working with octopress provides beginners a good opportunity to tinker around in a Ruby environment.</p>

<p>Installing octopress on my local machine Ubuntu 11.10 (Oneiric Ocelot) was met with some setbacks which I resolved as describe below:</p>

<p>At the time of installing octopress,a prerequistie for installation was Ruby 1.9.3. I used <a href="http://rvm.io">rvm</a>(Ruby Version Manager) as a utility to download the ruby binary. Unfortunately my installiation failed when running rvm install 1.9.3, so I re-ran the installation command in <em>debug mode</em> to print out additional output to locate the source of this issue.</p>

<figure class='code'><figcaption><span>Ruby Installation in Debug mode</span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rvm install 1.9.3 --debug</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Installation Response Snippet</span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>1.9.3 - install
</span><span class='line'>Searching for binary rubies, this might take some time.
</span><span class='line'>Remote file does not exist https://rvm.io/binaries/ubuntu/11.10/i386/ruby-1.9.3-p392.tar.bz2
</span><span class='line'>Remote file does not exist http://jruby.org.s3.amazonaws.com/downloads/ruby-1.9.3-p392.tar.bz2
</span><span class='line'>Remote file does not exist http://binaries.rubini.us/ubuntu/11.10/i386/ruby-1.9.3-p392.tar.bz2
</span><span class='line'>...
</span><span class='line'>No remote file name found
</span><span class='line'>No binary rubies available for: ubuntu/11.10/i386/ruby-1.9.3-p392.</span></code></pre></td></tr></table></div></figure>


<p>It turned out the public release 392(p392) binary file for 32-bit Ubuntu 11.10 could not be located from the various urls referenced by rvm and I couldn&#8217;t locate the binaries via a Google search either.</p>

<p>After browsing around I also tried a solution that uses ruby-rvm, but also discovered that <a href="http://stackoverflow.com/questions/9056008/installed-ruby-1-9-3-with-rvm-but-command-line-doesnt-show-ruby-v/9056395#9056395">Ubuntu warps ruby-rvm</a>.</p>

<p>I ended install the head of ruby-1.9.3 and also ruby-2.0.0. So far I have been running octopress on ruby-2.0.0 and have not encountered any issues.</p>

<figure class='code'><figcaption><span>Ruby-head Installation</span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rvm install ruby-1.9.3-head --autolibs=3 --debug
</span><span class='line'>#--autolibs=3 automatically installs packages/dependicies needed or that require updates</span></code></pre></td></tr></table></div></figure>


<p>After downloading the 1.9.3-head and 2.0.0 binaries, I had issues running bundle install (which installs dependencies specified in my Gemfile). The error reported the bundler itself not being installed even though I installed it in the previous command.
It turned out that my bundler was installed to a specific gemset and once I installed the bundler to the global gemset, bundle install could be executed.</p>

<figure class='code'><figcaption><span>Installing bundler to global gemset</span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>bundle install
</span><span class='line'>ERROR: Gem bundler is not installed, run `gem install bundler` first.
</span><span class='line'>
</span><span class='line'>rvm gemset use global && gem install bundler
</span><span class='line'>http://stackoverflow.com/questions/12326705/error-gem-bundler-is-not-installed-run-gem-install-bundler-first</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/11/24/understanding-pseudoclassical-inheritance-in-javascript/">Understanding Pseudoclassical Inheritance in JavaScript</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/10/27/additional-things-i-learned-from-jquery-source/">Additional Things I learned from jQuery Source</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/07/understanding-the-intuition-of-easing/">Understanding the Intuition of Easing</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/05/24/what-i-learned-from-launching-version-2-of-my-portfolio/">What I learned from launching version 2 of my portfolio</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/12/29/attribute-nodes-of-html-elements/">Attribute Nodes of HTML Elements</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Anthony Su -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'radialglo';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
